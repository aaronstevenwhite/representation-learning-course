<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.321">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Representation Learning for Syntactic and Semantic Theory - Projective Content</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../selection/index.html" rel="next">
<link href="../island-effects/model-fitting-and-comparison.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../projective-content/index.html">Module 2: Projective Content</a></li><li class="breadcrumb-item"><a href="../projective-content/index.html">Projective Content</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Representation Learning for Syntactic and Semantic Theory</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../motivations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motivations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../methodological-approach.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Methodological Approach</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-structure-and-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Structure and Content</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Foundational Concepts in Probability and Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundational-concepts-in-probability-and-statistics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is a probability?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundational-concepts-in-probability-and-statistics/random-variables-and-probability-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random variables and probability distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundational-concepts-in-probability-and-statistics/statistical-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Module 1: Island Effects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../island-effects/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../island-effects/model-definition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model definition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../island-effects/model-fitting-and-comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Fitting and Comparison</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projective-content/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Projective Content</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../selection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 3: Selection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../thematic-roles/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 4: Thematic Roles</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#projection-data" id="toc-projection-data" class="nav-link active" data-scroll-target="#projection-data">Projection Data</a></li>
  <li><a href="#replication" id="toc-replication" class="nav-link" data-scroll-target="#replication">Replication</a></li>
  <li><a href="#bleached" id="toc-bleached" class="nav-link" data-scroll-target="#bleached">Bleached</a></li>
  <li><a href="#templatic" id="toc-templatic" class="nav-link" data-scroll-target="#templatic">Templatic</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Projective Content</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reading
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Data:</strong> <span class="citation" data-cites="degen_prior_2021">Degen and Tonhauser (<a href="#ref-degen_prior_2021" role="doc-biblioref">2021</a>)</span> on how prior beliefs modulate projectivity inferences. We will use the data collected for that paper, which can be found <a href="https://github.com/judith-tonhauser/projective-probability">here</a>, in this module.</p>
<p><strong>Theory:</strong> <span class="citation" data-cites="degen_factive_2022">Degen and Tonhauser (<a href="#ref-degen_factive_2022" role="doc-biblioref">2022</a>)</span> on whether there is a discrete category of factive predicates. As shown in <span class="citation" data-cites="kane_intensional_2022">Kane, Gantt, and White (<a href="#ref-kane_intensional_2022" role="doc-biblioref">2022</a>)</span>, the main conceit of the paper–that there is no such discrete category–does not hold up under empirical scrutiny. We will rather be concerned with their discussion–broadly, but most specifically in Section 4–about the sources of gradience.</p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!git clone https://github.com/judith-tonhauser/projective-probability.git data/projective-probability/</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data_dir <span class="op">=</span> <span class="st">"data/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_norming_data(fname: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.read_csv(fname, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data[<span class="op">~</span>data.item.isin([<span class="st">"F1"</span>, <span class="st">"F2"</span>])]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data.drop(columns<span class="op">=</span><span class="st">"comments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_norming <span class="op">=</span> load_norming_data(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    os.path.join(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        data_dir, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"projective-probability/results/1-prior/data/cd.csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>data_norming</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">workerid</th>
<th data-quarto-table-cell-role="th">rt</th>
<th data-quarto-table-cell-role="th">prompt</th>
<th data-quarto-table-cell-role="th">itemType</th>
<th data-quarto-table-cell-role="th">itemNr</th>
<th data-quarto-table-cell-role="th">list</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">response</th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">slide_number_in_experiment</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">american</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">language</th>
<th data-quarto-table-cell-role="th">Answer.time_in_minutes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>8398</td>
<td>How likely is it that Frank got a cat?</td>
<td>H</td>
<td>12</td>
<td>1</td>
<td>12H</td>
<td>0.83</td>
<td>Frank has always wanted a pet.</td>
<td>2</td>
<td>Male</td>
<td>0</td>
<td>29</td>
<td>english</td>
<td>2.08630</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>3505</td>
<td>How likely is it that Isabella ate a steak on ...</td>
<td>L</td>
<td>7</td>
<td>1</td>
<td>7L</td>
<td>0.14</td>
<td>Isabella is a vegetarian.</td>
<td>3</td>
<td>Male</td>
<td>0</td>
<td>29</td>
<td>english</td>
<td>2.08630</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>3526</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>H</td>
<td>10</td>
<td>1</td>
<td>10H</td>
<td>0.93</td>
<td>Zoe is a math major.</td>
<td>4</td>
<td>Male</td>
<td>0</td>
<td>29</td>
<td>english</td>
<td>2.08630</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0</td>
<td>2414</td>
<td>How likely is it that Emma studied on Saturday...</td>
<td>L</td>
<td>3</td>
<td>1</td>
<td>3L</td>
<td>0.64</td>
<td>Emma is in first grade.</td>
<td>6</td>
<td>Male</td>
<td>0</td>
<td>29</td>
<td>english</td>
<td>2.08630</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0</td>
<td>2540</td>
<td>How likely is it that Jackson ran 10 miles?</td>
<td>L</td>
<td>13</td>
<td>1</td>
<td>13L</td>
<td>0.25</td>
<td>Jackson is obese.</td>
<td>7</td>
<td>Male</td>
<td>0</td>
<td>29</td>
<td>english</td>
<td>2.08630</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2086</td>
<td>94</td>
<td>2881</td>
<td>How likely is it that Emma studied on Saturday...</td>
<td>H</td>
<td>3</td>
<td>2</td>
<td>3H</td>
<td>0.97</td>
<td>Emma is in law school.</td>
<td>19</td>
<td>Female</td>
<td>0</td>
<td>39</td>
<td>english</td>
<td>1.78135</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2087</td>
<td>94</td>
<td>2744</td>
<td>How likely is it that Olivia sleeps until noon?</td>
<td>L</td>
<td>4</td>
<td>2</td>
<td>4L</td>
<td>0.05</td>
<td>Olivia has two small children.</td>
<td>20</td>
<td>Female</td>
<td>0</td>
<td>39</td>
<td>english</td>
<td>1.78135</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2088</td>
<td>94</td>
<td>2403</td>
<td>How likely is it that Jon walks to work?</td>
<td>H</td>
<td>19</td>
<td>2</td>
<td>19H</td>
<td>0.94</td>
<td>Jon lives 2 blocks away from work.</td>
<td>21</td>
<td>Female</td>
<td>0</td>
<td>39</td>
<td>english</td>
<td>1.78135</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2089</td>
<td>94</td>
<td>2366</td>
<td>How likely is it that Julian dances salsa?</td>
<td>L</td>
<td>18</td>
<td>2</td>
<td>18L</td>
<td>0.18</td>
<td>Julian is German.</td>
<td>22</td>
<td>Female</td>
<td>0</td>
<td>39</td>
<td>english</td>
<td>1.78135</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2090</td>
<td>94</td>
<td>3337</td>
<td>How likely is it that Jayden rented a car?</td>
<td>L</td>
<td>14</td>
<td>2</td>
<td>14L</td>
<td>0.00</td>
<td>Jayden doesn&amp;quotechart have a driver&amp;quotecha...</td>
<td>23</td>
<td>Female</td>
<td>0</td>
<td>39</td>
<td>english</td>
<td>1.78135</td>
</tr>
</tbody>
</table>

<p>1500 rows × 15 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext rpy2.ipython</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i data_norming <span class="op">-</span>w <span class="dv">20</span> <span class="op">-</span>h <span class="dv">8</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>library(ggplot2)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>theme_set(theme_classic())</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(data_norming, aes(x<span class="op">=</span>prompt, y<span class="op">=</span>response, fill<span class="op">=</span>itemType)) <span class="op">+</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>geom_boxplot() <span class="op">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>coord_flip() <span class="op">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>scale_fill_manual(name<span class="op">=</span><span class="st">"Intended Likelihood"</span>, values<span class="op">=</span>c(<span class="st">"#CD5400"</span>, <span class="st">"#133B6C"</span>)) <span class="op">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>theme(axis.title.x<span class="op">=</span>element_blank(),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>, hjust<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      axis.ticks.y<span class="op">=</span>element_blank(),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>      legend.title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>      legend.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>      legend.position<span class="op">=</span><span class="st">"bottom"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"norming-empirical-distributions.png"</span>, width<span class="op">=</span><span class="dv">20</span>, height<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>R[write to console]: Use suppressPackageStartupMessages() to eliminate package startup
messages
</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-6-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_norming_sub <span class="op">=</span> data_norming.query(<span class="st">'item.isin(["10H", "10L"])'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i data_norming_sub <span class="op">-</span>w <span class="dv">8</span> <span class="op">-</span>h <span class="dv">4</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(data_norming_sub, aes(x<span class="op">=</span>response, fill<span class="op">=</span>fact)) <span class="op">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>geom_histogram(color<span class="op">=</span><span class="st">"black"</span>, bins<span class="op">=</span><span class="dv">20</span>) <span class="op">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>scale_fill_manual(name<span class="op">=</span><span class="st">"Fact"</span>, values<span class="op">=</span>c(<span class="st">"#133B6C"</span>, <span class="st">"#CD5400"</span>)) <span class="op">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>theme(axis.title.x<span class="op">=</span>element_blank(),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      axis.text.y<span class="op">=</span>element_blank(),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>, hjust<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>      axis.ticks.y<span class="op">=</span>element_blank(),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>      legend.title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>      legend.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>      legend.position<span class="op">=</span><span class="st">"bottom"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"norming-empirical-example.png"</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmdstanpy, arviz</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> abc <span class="im">import</span> ABC, abstractmethod, abstractproperty</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Optional</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cmdstanpy <span class="im">import</span> CmdStanModel</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Optional</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> enum <span class="im">import</span> Enum</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arviz <span class="im">import</span> InferenceData</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FitType(Enum):</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    OPTIMIZE <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    SAMPLE <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> StanModel(ABC):</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">**</span>kwargs):</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> CmdStanModel(stan_file<span class="op">=</span><span class="va">self</span>.stan_file)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.init_params <span class="op">=</span> kwargs</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractproperty</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> stan_file(<span class="va">self</span>): </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">NotImplementedError</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_model_data(<span class="va">self</span>, data: pd.DataFrame):</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">NotImplementedError</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _validate_data(<span class="va">self</span>):</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_class(<span class="op">**</span><span class="va">self</span>.model_data)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        data: pd.DataFrame,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        fit_type: FitType <span class="op">=</span> FitType.SAMPLE,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        map_initialization: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        save_dir: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        verbose: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">**</span>kwargs</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> InferenceData:</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_data <span class="op">=</span> <span class="va">self</span>.construct_model_data(data)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._validate_data()</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fit_type <span class="op">=</span> fit_type</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> fit_type <span class="op">==</span> FitType.SAMPLE:</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> verbose:</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"Fitting model by sampling..."</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> map_initialization:</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"Initializing sampling at MAP..."</span>)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>                init_model <span class="op">=</span> <span class="va">self</span>.__class__(<span class="op">**</span><span class="va">self</span>.init_params)</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>                init_model.fit(data, fit_type<span class="op">=</span>FitType.OPTIMIZE, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>                map_estimate <span class="op">=</span> init_model.raw_model_fit.stan_variables()</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"inits"</span> <span class="kw">in</span> kwargs:</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># inits passed to fit() should override MAP</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>                    map_estimate.update(kwargs[<span class="st">"inits"</span>])</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>                kwargs[<span class="st">"inits"</span>] <span class="op">=</span> map_estimate</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.raw_model_fit <span class="op">=</span> <span class="va">self</span>.model.sample(</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>                data<span class="op">=</span><span class="va">self</span>.model_data,</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>                <span class="op">**</span>kwargs</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> verbose:</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"Fitting model by optimizing..."</span>)</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.raw_model_fit <span class="op">=</span> <span class="va">self</span>.model.optimize(</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>                data<span class="op">=</span><span class="va">self</span>.model_data,</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>                <span class="op">**</span>kwargs</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> save_dir <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> verbose:</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"Saving model..."</span>)</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.save(save_dir)</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> model_fit(<span class="va">self</span>):</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.fit_type <span class="op">==</span> FitType.SAMPLE:</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> arviz.from_cmdstanpy(</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.raw_model_fit, </span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>                coords<span class="op">=</span><span class="va">self</span>.coords <span class="cf">if</span> <span class="bu">hasattr</span>(<span class="va">self</span>, <span class="st">"coords"</span>) <span class="cf">else</span> {},</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>                dims<span class="op">=</span><span class="va">self</span>.dims <span class="cf">if</span> <span class="bu">hasattr</span>(<span class="va">self</span>, <span class="st">"dims"</span>) <span class="cf">else</span> {}</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.raw_model_fit</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save(<span class="va">self</span>, save_dir: <span class="bu">str</span> <span class="op">=</span> <span class="st">"."</span>):</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.raw_model_fit.save_csvfiles(save_dir)</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> from_csv(cls, path: <span class="bu">str</span>, <span class="op">**</span>kwargs):</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> cls(<span class="op">**</span>kwargs)</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>        model.raw_model_fit <span class="op">=</span> cmdstanpy.from_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pygments <span class="im">import</span> highlight</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pygments.formatters <span class="im">import</span> HtmlFormatter</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pygments.lexers.modeling <span class="im">import</span> StanLexer</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML, display</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>model_dir <span class="op">=</span> <span class="st">"models/"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>norming_model_path <span class="op">=</span> os.path.join(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"norming-model/norming-model.stan"</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(norming_model_path, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">functions</span> <span class="p">{</span>
  <span class="c1">// from https://mc-stan.org/docs/2_18/stan-users-guide/truncated-random-number-generation.html</span>
  <span class="kt">real</span> <span class="n">normal_lub_rng</span><span class="p">(</span><span class="kt">real</span> <span class="n">mu</span><span class="p">,</span> <span class="kt">real</span> <span class="n">sigma</span><span class="p">,</span> <span class="kt">real</span> <span class="n">lb</span><span class="p">,</span> <span class="kt">real</span> <span class="n">ub</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">real</span> <span class="n">p_lb</span> <span class="o">=</span> <span class="nb">normal_cdf</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">p_ub</span> <span class="o">=</span> <span class="nb">normal_cdf</span><span class="p">(</span><span class="n">ub</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">u</span> <span class="o">=</span> <span class="nb">uniform_rng</span><span class="p">(</span><span class="n">p_lb</span><span class="p">,</span> <span class="n">p_ub</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="nb">Phi</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kn">data</span> <span class="p">{</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">N_resp</span><span class="p">;</span>                           <span class="c1">// number of responses</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">N_context</span><span class="p">;</span>                        <span class="c1">// number of contexts</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">N_subj</span><span class="p">;</span>                           <span class="c1">// number of subjects</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">1</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="n">N_context</span><span class="o">&gt;</span> <span class="n">context</span><span class="p">[</span><span class="n">N_resp</span><span class="p">];</span>  <span class="c1">// context corresponding to response n</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">1</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="n">N_subj</span><span class="o">&gt;</span> <span class="n">subj</span><span class="p">[</span><span class="n">N_resp</span><span class="p">];</span>        <span class="c1">// subject corresponding to response n</span>
  <span class="kt">vector</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="mf">1</span><span class="o">&gt;</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">resp</span><span class="p">;</span>          <span class="c1">// bounded slider response     </span>
<span class="p">}</span>

<span class="kn">parameters</span> <span class="p">{</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">context_intercept_std</span><span class="p">;</span>           <span class="c1">// the context random intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept</span><span class="p">;</span>           <span class="c1">// the context random intercepts</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_std</span><span class="p">;</span>              <span class="c1">// the subject random intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept</span><span class="p">;</span>                 <span class="c1">// the subject random intercepts</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="mf">1</span><span class="o">&gt;</span> <span class="n">sigma</span><span class="p">;</span>
<span class="p">}</span>

<span class="kn">transformed parameters</span> <span class="p">{</span>
  <span class="kt">real</span> <span class="n">mu</span><span class="p">[</span><span class="n">N_resp</span><span class="p">];</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span>
    <span class="n">mu</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span><span class="n">context_intercept</span><span class="p">[</span><span class="n">context</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]);</span>
<span class="p">}</span>

<span class="kn">model</span> <span class="p">{</span>
  <span class="n">context_intercept_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>

  <span class="c1">// sample the context intercepts</span>
  <span class="n">context_intercept</span> <span class="o">~</span><span class="w"> </span><span class="nb">normal</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">context_intercept_std</span><span class="p">);</span>

  <span class="c1">// sample the subject intercepts</span>
  <span class="n">subj_intercept</span> <span class="o">~</span><span class="w"> </span><span class="nb">normal</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">subj_intercept_std</span><span class="p">);</span>
  
  <span class="c1">// sample the responses</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span>
    <span class="n">resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">~</span><span class="w"> </span><span class="nb">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">sigma</span><span class="p">)</span> <span class="k">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="kn">generated quantities</span> <span class="p">{</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_prob</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_context</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">context_prob</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">context_intercept</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">resp_pp_rep</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">){</span>
    <span class="n">resp_pp_rep</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">normal_lub_rng</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">sigma</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> ndarray</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> CategoricalDtype</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hash_series(series: pd.Series, categories: Optional[<span class="bu">list</span>[<span class="bu">str</span>]] <span class="op">=</span> <span class="va">None</span>, indexation: <span class="bu">int</span><span class="op">=</span><span class="dv">1</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[ndarray, ndarray]:</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Hash a series to numeric codes</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">    column</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">        The series to hash</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">    index</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The starting index (defaults to 1)</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># enforce 0- or 1-indexation</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> indexation <span class="kw">not</span> <span class="kw">in</span> [<span class="dv">0</span>, <span class="dv">1</span>]:</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Must choose either 0- or 1-indexation."</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert the series to a category</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> categories <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        category_series <span class="op">=</span> series.astype(<span class="st">"category"</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        cat_type <span class="op">=</span> CategoricalDtype(categories<span class="op">=</span>categories)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        category_series <span class="op">=</span> series.astype(cat_type)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the hash</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    hash_map <span class="op">=</span> category_series.cat.categories.values</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># map to one-indexed codes</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    hashed_series <span class="op">=</span> (category_series.cat.codes <span class="op">+</span> indexation).values</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hash_map, hashed_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NormingData:</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    N_resp: <span class="bu">int</span>                  <span class="co"># number of responses</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    N_context: <span class="bu">int</span>               <span class="co"># number of contexts</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    N_subj: <span class="bu">int</span>                  <span class="co"># number of subjects</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    context: ndarray             <span class="co"># context corresponding to response n</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    subj: ndarray                <span class="co"># subject who gave response n</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    resp: ndarray                <span class="co"># likert scale acceptability judgment responses</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NormingModel(StanModel):</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    stan_file <span class="op">=</span> norming_model_path</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    data_class <span class="op">=</span> NormingData</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_context_info(<span class="va">self</span>, data: pd.DataFrame):</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.context_info <span class="op">=</span> data[[<span class="st">"item"</span>, <span class="st">"prompt"</span>, <span class="st">"fact"</span>]].drop_duplicates(ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.context_info <span class="op">=</span> <span class="va">self</span>.context_info.rename(columns<span class="op">=</span>{<span class="st">"item"</span>: <span class="st">"context"</span>})</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_model_data(<span class="va">self</span>, data: pd.DataFrame):</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.construct_context_info(data)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(<span class="va">self</span>, <span class="st">"subj_hash_map"</span>):</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>            _, subj_hashed <span class="op">=</span> hash_series(data.workerid, <span class="va">self</span>.subj_hash_map)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.subj_hash_map, subj_hashed <span class="op">=</span> hash_series(data.workerid)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(<span class="va">self</span>, <span class="st">"context_hash_map"</span>):</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>            _, context_hashed <span class="op">=</span> hash_series(data.item, <span class="va">self</span>.context_hash_map)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.context_hash_map, context_hashed <span class="op">=</span> hash_series(data.item)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.coords <span class="op">=</span> {</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"subj"</span>: <span class="va">self</span>.subj_hash_map,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">"context"</span>: <span class="va">self</span>.context_hash_map</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dims <span class="op">=</span> {</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">"context_intercept"</span>: [<span class="st">"context"</span>],</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">"context_prob"</span>: [<span class="st">"context"</span>],</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_data <span class="op">=</span> {</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">"N_resp"</span>: data.shape[<span class="dv">0</span>],</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">"N_context"</span>: <span class="va">self</span>.context_hash_map.shape[<span class="dv">0</span>],</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">"N_subj"</span>: <span class="va">self</span>.subj_hash_map.shape[<span class="dv">0</span>],</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">"context"</span>: context_hashed,</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">"subj"</span>: subj_hashed,</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">"resp"</span>: data.response.astype(<span class="bu">float</span>).values</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.model_data</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> context_posterior_estimates(<span class="va">self</span>):</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.fit_type <span class="op">==</span> FitType.SAMPLE:</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>            context_intercept_samples <span class="op">=</span> <span class="va">self</span>.raw_model_fit.stan_variable(<span class="st">"context_intercept"</span>)</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>            params <span class="op">=</span> []</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(context_intercept_samples.shape[<span class="dv">1</span>]):</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>                mu, sigma <span class="op">=</span> norm.fit(context_intercept_samples[:,i])</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>                context <span class="op">=</span> <span class="va">self</span>.context_hash_map[i]</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>                params.append([context, mu, sigma])</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>            params_df <span class="op">=</span> pd.DataFrame(params, columns<span class="op">=</span>[<span class="st">"context"</span>, <span class="st">"context_mean"</span>, <span class="st">"context_std"</span>])</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>            params_df[<span class="st">"order"</span>] <span class="op">=</span> params_df.index</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>            params_df <span class="op">=</span> pd.merge(params_df, <span class="va">self</span>.context_info).sort_values(<span class="st">"order"</span>)</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> params_df[[<span class="st">"fact"</span>, <span class="st">"context"</span>, <span class="st">"prompt"</span>, <span class="st">"context_mean"</span>, <span class="st">"context_std"</span>, <span class="st">"order"</span>]]</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">NotImplementedError</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>norming_model <span class="op">=</span> NormingModel().fit(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    data_norming, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>16:57:41 - cmdstanpy - INFO - CmdStan start processing
16:58:20 - cmdstanpy - INFO - CmdStan done processing.
16:58:20 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in '/home/jovyan/work/projective-content/models/norming-model/norming-model.stan', line 40, column 2 to column 55)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in '/home/jovyan/work/projective-content/models/norming-model/norming-model.stan', line 43, column 2 to column 49)
Consider re-running with show_console=True if the above output is unclear!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3a86386b2bfa4edcbb331a84d3a6e0ee","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e669fa167f064b26b23dc6a602bd419b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8565521e996946ba9f1c90091b59362b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2b4eaa3050ab42109360c969d295be9d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    norming_model.model_fit,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"context_intercept"</span>],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">10</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    norming_model.model_fit,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"context_prob"</span>],</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">10</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> pd.DataFrame(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    norming_model.raw_model_fit.stan_variable(<span class="st">"context_intercept"</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>norming_model.context_hash_map</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> pd.merge(pd.melt(samples, var_name<span class="op">=</span><span class="st">"context"</span>), norming_model.context_info)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>samples[<span class="st">"itemType"</span>] <span class="op">=</span> samples.context.<span class="bu">map</span>(<span class="kw">lambda</span> x: x[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>samples_sub <span class="op">=</span> samples.query(<span class="st">'context.isin(["10H", "10L"])'</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>samples_sub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">context</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">prompt</th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">itemType</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10H</td>
<td>1.86212</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is a math major.</td>
<td>H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10H</td>
<td>1.73999</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is a math major.</td>
<td>H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>10H</td>
<td>1.38718</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is a math major.</td>
<td>H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>10H</td>
<td>1.73442</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is a math major.</td>
<td>H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>10H</td>
<td>1.86627</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is a math major.</td>
<td>H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15995</td>
<td>10L</td>
<td>-6.97041</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is 5 years old.</td>
<td>L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15996</td>
<td>10L</td>
<td>-4.89358</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is 5 years old.</td>
<td>L</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15997</td>
<td>10L</td>
<td>-6.17656</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is 5 years old.</td>
<td>L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15998</td>
<td>10L</td>
<td>-4.68528</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is 5 years old.</td>
<td>L</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15999</td>
<td>10L</td>
<td>-4.80183</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>Zoe is 5 years old.</td>
<td>L</td>
</tr>
</tbody>
</table>

<p>16000 rows × 5 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i samples <span class="op">-</span>w <span class="dv">20</span> <span class="op">-</span>h <span class="dv">8</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(samples, aes(x<span class="op">=</span>prompt, y<span class="op">=</span>plogis(value), fill<span class="op">=</span>itemType)) <span class="op">+</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>geom_boxplot() <span class="op">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>coord_flip() <span class="op">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>scale_fill_manual(name<span class="op">=</span><span class="st">"Intended Likelihood"</span>, values<span class="op">=</span>c(<span class="st">"#CD5400"</span>, <span class="st">"#133B6C"</span>)) <span class="op">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>theme(axis.title.x<span class="op">=</span>element_blank(),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>      axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>, hjust<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>      axis.ticks.y<span class="op">=</span>element_blank(),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>      legend.title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>      legend.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>      legend.position<span class="op">=</span><span class="st">"bottom"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"norming-posterior-distributions.png"</span>, width<span class="op">=</span><span class="dv">20</span>, height<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i samples_sub <span class="op">-</span>w <span class="dv">8</span> <span class="op">-</span>h <span class="dv">4</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(samples_sub, aes(x<span class="op">=</span>plogis(value), fill<span class="op">=</span>fact)) <span class="op">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>geom_histogram(color<span class="op">=</span><span class="st">"black"</span>) <span class="op">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>scale_fill_manual(name<span class="op">=</span><span class="st">"Fact"</span>, values<span class="op">=</span>c(<span class="st">"#133B6C"</span>, <span class="st">"#CD5400"</span>)) <span class="op">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>theme(axis.title.x<span class="op">=</span>element_blank(),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      axis.text.y<span class="op">=</span>element_blank(),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>, hjust<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>      axis.ticks.y<span class="op">=</span>element_blank(),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>      legend.title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>      legend.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>      legend.position<span class="op">=</span><span class="st">"bottom"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"norming-posterior-example.png"</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>context_posterior_estimates <span class="op">=</span> norming_model.context_posterior_estimates</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>context_posterior_estimates <span class="op">=</span> context_posterior_estimates.set_index(<span class="st">"context"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>context_posterior_estimates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">prompt</th>
<th data-quarto-table-cell-role="th">context_mean</th>
<th data-quarto-table-cell-role="th">context_std</th>
<th data-quarto-table-cell-role="th">order</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">context</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">10H</td>
<td>Zoe is a math major.</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>1.682417</td>
<td>0.260563</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10L</td>
<td>Zoe is 5 years old.</td>
<td>How likely is it that Zoe calculated the tip?</td>
<td>-6.355352</td>
<td>2.062079</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11H</td>
<td>Danny loves cake.</td>
<td>How likely is it that Danny ate the last cupcake?</td>
<td>1.018309</td>
<td>0.203021</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11L</td>
<td>Danny is a diabetic.</td>
<td>How likely is it that Danny ate the last cupcake?</td>
<td>-1.509393</td>
<td>0.244486</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12H</td>
<td>Frank has always wanted a pet.</td>
<td>How likely is it that Frank got a cat?</td>
<td>0.616739</td>
<td>0.173204</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12L</td>
<td>Frank is allergic to cats.</td>
<td>How likely is it that Frank got a cat?</td>
<td>-6.199000</td>
<td>2.069092</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13H</td>
<td>Jackson is training for a marathon.</td>
<td>How likely is it that Jackson ran 10 miles?</td>
<td>3.245416</td>
<td>1.387925</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13L</td>
<td>Jackson is obese.</td>
<td>How likely is it that Jackson ran 10 miles?</td>
<td>-6.059125</td>
<td>2.052598</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14H</td>
<td>Jayden&amp;quotechars car is in the shop.</td>
<td>How likely is it that Jayden rented a car?</td>
<td>0.927931</td>
<td>0.187294</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14L</td>
<td>Jayden doesn&amp;quotechart have a driver&amp;quotecha...</td>
<td>How likely is it that Jayden rented a car?</td>
<td>-6.393834</td>
<td>2.015194</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15H</td>
<td>Tony really likes to party with his friends.</td>
<td>How likely is it that Tony had a drink last ni...</td>
<td>1.206240</td>
<td>0.220239</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15L</td>
<td>Tony has been sober for 20 years.</td>
<td>How likely is it that Tony had a drink last ni...</td>
<td>-6.366472</td>
<td>2.056782</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16H</td>
<td>Josh is a 5-year old boy.</td>
<td>How likely is it that Josh learned to ride a b...</td>
<td>0.057201</td>
<td>0.163356</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16L</td>
<td>Josh is a 75-year old man.</td>
<td>How likely is it that Josh learned to ride a b...</td>
<td>-1.833179</td>
<td>0.329030</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17H</td>
<td>Owen lives in Chicago.</td>
<td>How likely is it that Owen shoveled snow last ...</td>
<td>2.475157</td>
<td>0.767011</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17L</td>
<td>Owen lives in New Orleans.</td>
<td>How likely is it that Owen shoveled snow last ...</td>
<td>-2.522741</td>
<td>0.725632</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18H</td>
<td>Julian is Cuban.</td>
<td>How likely is it that Julian dances salsa?</td>
<td>0.479795</td>
<td>0.170149</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18L</td>
<td>Julian is German.</td>
<td>How likely is it that Julian dances salsa?</td>
<td>-0.880394</td>
<td>0.196229</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19H</td>
<td>Jon lives 2 blocks away from work.</td>
<td>How likely is it that Jon walks to work?</td>
<td>2.643558</td>
<td>1.153087</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19L</td>
<td>Jon lives 10 miles away from work.</td>
<td>How likely is it that Jon walks to work?</td>
<td>-5.967802</td>
<td>2.121788</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1H</td>
<td>Mary is taking a prenatal yoga class.</td>
<td>How likely is it that Mary is pregnant?</td>
<td>6.316258</td>
<td>2.085465</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1L</td>
<td>Mary is a middle school student.</td>
<td>How likely is it that Mary is pregnant?</td>
<td>-6.218693</td>
<td>2.029427</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20H</td>
<td>Charley lives in Mexico.</td>
<td>How likely is it that Charley speaks Spanish?</td>
<td>5.248629</td>
<td>1.994104</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20L</td>
<td>Charley lives in Korea.</td>
<td>How likely is it that Charley speaks Spanish?</td>
<td>-1.222150</td>
<td>0.227227</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2H</td>
<td>Josie loves France.</td>
<td>How likely is it that Josie went on vacation t...</td>
<td>1.072852</td>
<td>0.189547</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2L</td>
<td>Josie doesn&amp;quotechart have a passport.</td>
<td>How likely is it that Josie went on vacation t...</td>
<td>-6.708299</td>
<td>2.037273</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3H</td>
<td>Emma is in law school.</td>
<td>How likely is it that Emma studied on Saturday...</td>
<td>1.432735</td>
<td>0.234982</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3L</td>
<td>Emma is in first grade.</td>
<td>How likely is it that Emma studied on Saturday...</td>
<td>-1.469292</td>
<td>0.237151</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4H</td>
<td>Olivia works the third shift.</td>
<td>How likely is it that Olivia sleeps until noon?</td>
<td>1.301317</td>
<td>0.211503</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4L</td>
<td>Olivia has two small children.</td>
<td>How likely is it that Olivia sleeps until noon?</td>
<td>-6.558070</td>
<td>2.185053</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5H</td>
<td>Sophia is a hipster.</td>
<td>How likely is it that Sophia got a tattoo?</td>
<td>0.531817</td>
<td>0.185619</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5L</td>
<td>Sophia is a high end fashion model.</td>
<td>How likely is it that Sophia got a tattoo?</td>
<td>-1.305512</td>
<td>0.220097</td>
<td>31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6H</td>
<td>Mia is a college student.</td>
<td>How likely is it that Mia drank 2 cocktails la...</td>
<td>0.166250</td>
<td>0.167156</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6L</td>
<td>Mia is a nun.</td>
<td>How likely is it that Mia drank 2 cocktails la...</td>
<td>-5.650003</td>
<td>2.115700</td>
<td>33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7H</td>
<td>Isabella is from Argentina.</td>
<td>How likely is it that Isabella ate a steak on ...</td>
<td>0.070301</td>
<td>0.177369</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7L</td>
<td>Isabella is a vegetarian.</td>
<td>How likely is it that Isabella ate a steak on ...</td>
<td>-6.929570</td>
<td>2.008126</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8H</td>
<td>Emily has been saving for a year.</td>
<td>How likely is it that Emily bought a car yeste...</td>
<td>-0.061404</td>
<td>0.164572</td>
<td>36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8L</td>
<td>Emily never has any money.</td>
<td>How likely is it that Emily bought a car yeste...</td>
<td>-5.466696</td>
<td>2.081979</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9H</td>
<td>Grace loves her sister.</td>
<td>How likely is it that Grace visited her sister?</td>
<td>5.100720</td>
<td>2.145611</td>
<td>38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9L</td>
<td>Grace hates her sister.</td>
<td>How likely is it that Grace visited her sister?</td>
<td>-2.170407</td>
<td>0.437847</td>
<td>39</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> mgrid</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.special <span class="im">import</span> expit, logit</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.distributions.empirical_distribution <span class="im">import</span> ECDF</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_context_intercept_posterior(context_id: <span class="bu">str</span>, axis<span class="op">=</span><span class="st">"unit"</span>, plot_diff: <span class="bu">bool</span><span class="op">=</span><span class="va">True</span>):</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    context_estimates <span class="op">=</span> context_posterior_estimates.loc[context_id]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    estimated_dist <span class="op">=</span> norm(context_estimates.context_mean, context_estimates.context_std)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> norming_model.raw_model_fit.stan_variable(<span class="st">"context_intercept"</span>)[:,context_estimates.order]</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> axis <span class="op">==</span> <span class="st">"unit"</span>:</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>        x_axis <span class="op">=</span> mgrid[<span class="fl">0.01</span>:<span class="dv">1</span>:<span class="fl">0.01</span>]</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        samples <span class="op">=</span> expit(samples)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        ecdf <span class="op">=</span> sns.ecdfplot(samples)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        plt.plot(x_axis, estimated_dist.cdf(logit(x_axis)))</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> plot_diff:</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>            plt.plot(mgrid[<span class="fl">0.01</span>:<span class="dv">1</span>:<span class="fl">0.01</span>], ECDF(samples)(x_axis) <span class="op">-</span> estimated_dist.cdf(logit(x_axis)))</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> axis<span class="op">==</span><span class="st">"reals"</span>:</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        x_axis <span class="op">=</span> mgrid[samples.<span class="bu">min</span>():samples.<span class="bu">max</span>():<span class="fl">0.01</span>]</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>        ecdf <span class="op">=</span> sns.ecdfplot(samples)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>        plt.plot(x_axis, estimated_dist.cdf(x_axis))</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> plot_diff:</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            plt.plot(x_axis, ECDF(samples)(x_axis) <span class="op">-</span> estimated_dist.cdf(x_axis))</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"'axis' must be </span><span class="ch">\"</span><span class="st">unit</span><span class="ch">\"</span><span class="st"> or </span><span class="ch">\"</span><span class="st">reals</span><span class="ch">\"</span><span class="st">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plot_context_intercept_posterior(<span class="st">"7L"</span>, axis<span class="op">=</span><span class="st">"reals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot_context_intercept_posterior(<span class="st">"7L"</span>, axis<span class="op">=</span><span class="st">"unit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>plot_context_intercept_posterior(<span class="st">"16H"</span>, axis<span class="op">=</span><span class="st">"reals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plot_context_intercept_posterior(<span class="st">"16H"</span>, axis<span class="op">=</span><span class="st">"unit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plot_context_intercept_posterior(<span class="st">"1H"</span>, axis<span class="op">=</span><span class="st">"reals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>plot_context_intercept_posterior(<span class="st">"1H"</span>, axis<span class="op">=</span><span class="st">"unit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="projection-data" class="level1">
<h1>Projection Data</h1>
<div class="cell" data-tags="[]" data-execution_count="123">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_projection_data(fname: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.read_csv(fname, index_col<span class="op">=</span><span class="dv">0</span>).drop(columns<span class="op">=</span><span class="st">"comments"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data[data.trigger_class <span class="op">!=</span> <span class="st">"control"</span>]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">"itemType"</span>] <span class="op">=</span> data.fact_type.<span class="bu">str</span>.replace(<span class="st">"fact"</span>, <span class="st">""</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">"item"</span>] <span class="op">=</span> data.contentNr.astype(<span class="bu">str</span>) <span class="op">+</span> data.fact_type.<span class="bu">str</span>.replace(<span class="st">"fact"</span>, <span class="st">""</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="124">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>data_projection <span class="op">=</span> load_projection_data(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    os.path.join(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        data_dir, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"projective-probability/results/3-projectivity/data/cd.csv"</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>data_projection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">workerid</th>
<th data-quarto-table-cell-role="th">rt</th>
<th data-quarto-table-cell-role="th">subjectGender</th>
<th data-quarto-table-cell-role="th">speakerGender</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">verb</th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">fact_type</th>
<th data-quarto-table-cell-role="th">contentNr</th>
<th data-quarto-table-cell-role="th">trigger_class</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">slide_number_in_experiment</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">language</th>
<th data-quarto-table-cell-role="th">assess</th>
<th data-quarto-table-cell-role="th">american</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">Answer.time_in_minutes</th>
<th data-quarto-table-cell-role="th">assignmentid</th>
<th data-quarto-table-cell-role="th">itemType</th>
<th data-quarto-table-cell-role="th">item</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>3495</td>
<td>M</td>
<td>M</td>
<td>Emily bought a car yesterday</td>
<td>establish</td>
<td>Emily has been saving for a year</td>
<td>factH</td>
<td>8</td>
<td>NonProj</td>
<td>...</td>
<td>4</td>
<td>38</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.0626</td>
<td>3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3</td>
<td>H</td>
<td>8H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>3866</td>
<td>F</td>
<td>M</td>
<td>Frank got a cat</td>
<td>prove</td>
<td>Frank has always wanted a pet</td>
<td>factH</td>
<td>12</td>
<td>C</td>
<td>...</td>
<td>5</td>
<td>38</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.0626</td>
<td>3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3</td>
<td>H</td>
<td>12H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>0</td>
<td>2983</td>
<td>F</td>
<td>F</td>
<td>Charley speaks Spanish</td>
<td>reveal</td>
<td>Charley lives in Mexico</td>
<td>factH</td>
<td>20</td>
<td>NonProj</td>
<td>...</td>
<td>6</td>
<td>38</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.0626</td>
<td>3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3</td>
<td>H</td>
<td>20H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>0</td>
<td>4669</td>
<td>F</td>
<td>F</td>
<td>Jon walks to work</td>
<td>confirm</td>
<td>Jon lives 10 miles away from work</td>
<td>factL</td>
<td>19</td>
<td>C</td>
<td>...</td>
<td>7</td>
<td>38</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.0626</td>
<td>3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3</td>
<td>L</td>
<td>19L</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>0</td>
<td>3847</td>
<td>M</td>
<td>F</td>
<td>Mia drank 2 cocktails last night</td>
<td>acknowledge</td>
<td>Mia is a college student</td>
<td>factH</td>
<td>6</td>
<td>C</td>
<td>...</td>
<td>8</td>
<td>38</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.0626</td>
<td>3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3</td>
<td>H</td>
<td>6H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7792</td>
<td>299</td>
<td>11176</td>
<td>F</td>
<td>F</td>
<td>Jackson ran 10 miles</td>
<td>see</td>
<td>Jackson is obese</td>
<td>factL</td>
<td>13</td>
<td>NonProj</td>
<td>...</td>
<td>19</td>
<td>44</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>8.1216</td>
<td>3GA6AFUKOOP1JLQS5QJD0EN5HUOH3N</td>
<td>L</td>
<td>13L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7795</td>
<td>299</td>
<td>12196</td>
<td>F</td>
<td>F</td>
<td>Josh learned to ride a bike yesterday</td>
<td>reveal</td>
<td>Josh is a 75-year old man</td>
<td>factL</td>
<td>16</td>
<td>NonProj</td>
<td>...</td>
<td>22</td>
<td>44</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>8.1216</td>
<td>3GA6AFUKOOP1JLQS5QJD0EN5HUOH3N</td>
<td>L</td>
<td>16L</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7797</td>
<td>299</td>
<td>5205</td>
<td>M</td>
<td>F</td>
<td>Isabella ate a steak on Sunday</td>
<td>confirm</td>
<td>Isabella is from Argentina</td>
<td>factH</td>
<td>7</td>
<td>C</td>
<td>...</td>
<td>24</td>
<td>44</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>8.1216</td>
<td>3GA6AFUKOOP1JLQS5QJD0EN5HUOH3N</td>
<td>H</td>
<td>7H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7799</td>
<td>299</td>
<td>10590</td>
<td>M</td>
<td>M</td>
<td>Grace visited her sister</td>
<td>annoyed</td>
<td>Grace loves her sister</td>
<td>factH</td>
<td>9</td>
<td>NonProj</td>
<td>...</td>
<td>26</td>
<td>44</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>8.1216</td>
<td>3GA6AFUKOOP1JLQS5QJD0EN5HUOH3N</td>
<td>H</td>
<td>9H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7800</td>
<td>299</td>
<td>11976</td>
<td>F</td>
<td>M</td>
<td>Frank got a cat</td>
<td>admit</td>
<td>Frank has always wanted a pet</td>
<td>factH</td>
<td>12</td>
<td>C</td>
<td>...</td>
<td>27</td>
<td>44</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>8.1216</td>
<td>3GA6AFUKOOP1JLQS5QJD0EN5HUOH3N</td>
<td>H</td>
<td>12H</td>
</tr>
</tbody>
</table>

<p>5320 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="125">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i data_projection <span class="op">-</span>w <span class="dv">20</span> <span class="op">-</span>h <span class="dv">8</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>library(forcats)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(data_projection, aes(x<span class="op">=</span>fct_reorder(verb, response, .fun <span class="op">=</span> median), y<span class="op">=</span>response, fill<span class="op">=</span>itemType)) <span class="op">+</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>geom_boxplot() <span class="op">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>coord_flip() <span class="op">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>scale_fill_manual(name<span class="op">=</span><span class="st">"Intended Likelihood of Embedded Proposition"</span>, values<span class="op">=</span>c(<span class="st">"#CD5400"</span>, <span class="st">"#133B6C"</span>)) <span class="op">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>theme(axis.title.x<span class="op">=</span>element_blank(),</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>      axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>, color<span class="op">=</span><span class="st">"black"</span>),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>      axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>, hjust<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>      axis.ticks.y<span class="op">=</span>element_blank(),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>      legend.title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>      legend.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>      legend.position<span class="op">=</span><span class="st">"bottom"</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"projection-empirical-distributions.png"</span>, width<span class="op">=</span><span class="dv">20</span>, height<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="128">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data_projection_pretend <span class="op">=</span> data_projection.query(<span class="st">"verb == 'pretend'"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>data_projection_pretend</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">workerid</th>
<th data-quarto-table-cell-role="th">rt</th>
<th data-quarto-table-cell-role="th">subjectGender</th>
<th data-quarto-table-cell-role="th">speakerGender</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">verb</th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">fact_type</th>
<th data-quarto-table-cell-role="th">contentNr</th>
<th data-quarto-table-cell-role="th">trigger_class</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">slide_number_in_experiment</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">language</th>
<th data-quarto-table-cell-role="th">assess</th>
<th data-quarto-table-cell-role="th">american</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">Answer.time_in_minutes</th>
<th data-quarto-table-cell-role="th">assignmentid</th>
<th data-quarto-table-cell-role="th">itemType</th>
<th data-quarto-table-cell-role="th">item</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>0</td>
<td>4519</td>
<td>F</td>
<td>F</td>
<td>Owen shoveled snow last winter</td>
<td>pretend</td>
<td>Owen lives in New Orleans</td>
<td>factL</td>
<td>17</td>
<td>NonProj</td>
<td>...</td>
<td>22</td>
<td>38</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.062600</td>
<td>3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3</td>
<td>L</td>
<td>17L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>1</td>
<td>4002</td>
<td>F</td>
<td>M</td>
<td>Jackson ran 10 miles</td>
<td>pretend</td>
<td>Jackson is obese</td>
<td>factL</td>
<td>13</td>
<td>NonProj</td>
<td>...</td>
<td>10</td>
<td>24</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.624383</td>
<td>3JV9LGBJWTFC5EO34ILN3H9FXL4OGN</td>
<td>L</td>
<td>13L</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>2</td>
<td>4063</td>
<td>F</td>
<td>F</td>
<td>Danny ate the last cupcake</td>
<td>pretend</td>
<td>Danny loves cake</td>
<td>factH</td>
<td>11</td>
<td>NonProj</td>
<td>...</td>
<td>9</td>
<td>62</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.749250</td>
<td>379J5II41OH6FFPFLVF7BXK9P0KELF</td>
<td>H</td>
<td>11H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>3</td>
<td>1144</td>
<td>F</td>
<td>F</td>
<td>Josh learned to ride a bike yesterday</td>
<td>pretend</td>
<td>Josh is a 5-year old boy</td>
<td>factH</td>
<td>16</td>
<td>NonProj</td>
<td>...</td>
<td>21</td>
<td>26</td>
<td>english</td>
<td>No</td>
<td>m</td>
<td>m</td>
<td>3.103517</td>
<td>3VD82FOHKQPZO28Y2WP4DQO0ZTCOCD</td>
<td>H</td>
<td>16H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">118</td>
<td>4</td>
<td>1261</td>
<td>F</td>
<td>M</td>
<td>Tony had a drink last night</td>
<td>pretend</td>
<td>Tony really likes to party with his friends</td>
<td>factH</td>
<td>15</td>
<td>NonProj</td>
<td>...</td>
<td>15</td>
<td>26</td>
<td>english</td>
<td>No</td>
<td>m</td>
<td>f</td>
<td>3.117350</td>
<td>3WR9XG3T63CP8S3KSV2KJ6QHHRL74T</td>
<td>H</td>
<td>15H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7681</td>
<td>295</td>
<td>119833</td>
<td>M</td>
<td>M</td>
<td>Grace visited her sister</td>
<td>pretend</td>
<td>Grace loves her sister</td>
<td>factH</td>
<td>9</td>
<td>NonProj</td>
<td>...</td>
<td>12</td>
<td>30</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>28.691200</td>
<td>3T111IHZ5ER0NHTBI4WH5VSX4VUR99</td>
<td>H</td>
<td>9H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7704</td>
<td>296</td>
<td>10514</td>
<td>F</td>
<td>M</td>
<td>Jon walks to work</td>
<td>pretend</td>
<td>Jon lives 2 blocks away from work</td>
<td>factH</td>
<td>19</td>
<td>NonProj</td>
<td>...</td>
<td>9</td>
<td>23</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>14.448983</td>
<td>30BUDKLTXDWSDQMUT8Z0U8OC3AM5EK</td>
<td>H</td>
<td>19H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7737</td>
<td>297</td>
<td>7634</td>
<td>M</td>
<td>M</td>
<td>Zoe calculated the tip</td>
<td>pretend</td>
<td>Zoe is a math major</td>
<td>factH</td>
<td>10</td>
<td>NonProj</td>
<td>...</td>
<td>16</td>
<td>39</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>f</td>
<td>4.131933</td>
<td>345LHZDEDXT6O7WC5PQCJTCVB2P3U9</td>
<td>H</td>
<td>10H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7749</td>
<td>298</td>
<td>14916</td>
<td>F</td>
<td>M</td>
<td>Frank got a cat</td>
<td>pretend</td>
<td>Frank has always wanted a pet</td>
<td>factH</td>
<td>12</td>
<td>NonProj</td>
<td>...</td>
<td>2</td>
<td>50</td>
<td>english</td>
<td>No</td>
<td>m</td>
<td>f</td>
<td>1.927500</td>
<td>3OXV7EAXLERLMW6B97S93NYF8G7367</td>
<td>H</td>
<td>12H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7788</td>
<td>299</td>
<td>8720</td>
<td>M</td>
<td>M</td>
<td>Mary is pregnant</td>
<td>pretend</td>
<td>Mary is a middle school student</td>
<td>factL</td>
<td>1</td>
<td>NonProj</td>
<td>...</td>
<td>15</td>
<td>44</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>8.121600</td>
<td>3GA6AFUKOOP1JLQS5QJD0EN5HUOH3N</td>
<td>L</td>
<td>1L</td>
</tr>
</tbody>
</table>

<p>266 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="137">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i data_projection_pretend <span class="op">-</span>w <span class="dv">8</span> <span class="op">-</span>h <span class="dv">4</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>library(forcats)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(data_projection_pretend, aes(x<span class="op">=</span>response, fill<span class="op">=</span>itemType)) <span class="op">+</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>geom_histogram(color<span class="op">=</span><span class="st">"black"</span>, bins<span class="op">=</span><span class="dv">20</span>, position<span class="op">=</span><span class="st">"dodge"</span>) <span class="op">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>scale_fill_manual(name<span class="op">=</span><span class="st">"Intended Likelihood of Embedded Proposition"</span>, values<span class="op">=</span>c(<span class="st">"#133B6C"</span>, <span class="st">"#CD5400"</span>)) <span class="op">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>theme(axis.title.x<span class="op">=</span>element_blank(),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>      axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>      axis.text.y<span class="op">=</span>element_blank(),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>      axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>, hjust<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>      axis.ticks.y<span class="op">=</span>element_blank(),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>      legend.title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>      legend.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>      legend.position<span class="op">=</span><span class="st">"bottom"</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"projection-example-distributions-pretend.png"</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="130">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data_projection_know <span class="op">=</span> data_projection.query(<span class="st">"verb == 'know'"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>data_projection_know</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">workerid</th>
<th data-quarto-table-cell-role="th">rt</th>
<th data-quarto-table-cell-role="th">subjectGender</th>
<th data-quarto-table-cell-role="th">speakerGender</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">verb</th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">fact_type</th>
<th data-quarto-table-cell-role="th">contentNr</th>
<th data-quarto-table-cell-role="th">trigger_class</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">slide_number_in_experiment</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">language</th>
<th data-quarto-table-cell-role="th">assess</th>
<th data-quarto-table-cell-role="th">american</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">Answer.time_in_minutes</th>
<th data-quarto-table-cell-role="th">assignmentid</th>
<th data-quarto-table-cell-role="th">itemType</th>
<th data-quarto-table-cell-role="th">item</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>0</td>
<td>2792</td>
<td>F</td>
<td>F</td>
<td>Danny ate the last cupcake</td>
<td>know</td>
<td>Danny is a diabetic</td>
<td>factL</td>
<td>11</td>
<td>NonProj</td>
<td>...</td>
<td>16</td>
<td>38</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.062600</td>
<td>3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3</td>
<td>L</td>
<td>11L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>1</td>
<td>13530</td>
<td>F</td>
<td>F</td>
<td>Owen shoveled snow last winter</td>
<td>know</td>
<td>Owen lives in Chicago</td>
<td>factH</td>
<td>17</td>
<td>NonProj</td>
<td>...</td>
<td>2</td>
<td>24</td>
<td>english</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.624383</td>
<td>3JV9LGBJWTFC5EO34ILN3H9FXL4OGN</td>
<td>H</td>
<td>17H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">55</td>
<td>2</td>
<td>8575</td>
<td>M</td>
<td>M</td>
<td>Sophia got a tattoo</td>
<td>know</td>
<td>Sophia is a hipster</td>
<td>factH</td>
<td>5</td>
<td>NonProj</td>
<td>...</td>
<td>4</td>
<td>62</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>2.749250</td>
<td>379J5II41OH6FFPFLVF7BXK9P0KELF</td>
<td>H</td>
<td>5H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83</td>
<td>3</td>
<td>1209</td>
<td>F</td>
<td>M</td>
<td>Jackson ran 10 miles</td>
<td>know</td>
<td>Jackson is training for a marathon</td>
<td>factH</td>
<td>13</td>
<td>NonProj</td>
<td>...</td>
<td>6</td>
<td>26</td>
<td>english</td>
<td>No</td>
<td>m</td>
<td>m</td>
<td>3.103517</td>
<td>3VD82FOHKQPZO28Y2WP4DQO0ZTCOCD</td>
<td>H</td>
<td>13H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">121</td>
<td>4</td>
<td>736</td>
<td>F</td>
<td>F</td>
<td>Frank got a cat</td>
<td>know</td>
<td>Frank is allergic to cats</td>
<td>factL</td>
<td>12</td>
<td>NonProj</td>
<td>...</td>
<td>18</td>
<td>26</td>
<td>english</td>
<td>No</td>
<td>m</td>
<td>f</td>
<td>3.117350</td>
<td>3WR9XG3T63CP8S3KSV2KJ6QHHRL74T</td>
<td>L</td>
<td>12L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7696</td>
<td>295</td>
<td>4896</td>
<td>F</td>
<td>M</td>
<td>Frank got a cat</td>
<td>know</td>
<td>Frank is allergic to cats</td>
<td>factL</td>
<td>12</td>
<td>NonProj</td>
<td>...</td>
<td>27</td>
<td>30</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>28.691200</td>
<td>3T111IHZ5ER0NHTBI4WH5VSX4VUR99</td>
<td>L</td>
<td>12L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7697</td>
<td>296</td>
<td>11885</td>
<td>M</td>
<td>F</td>
<td>Olivia sleeps until noon</td>
<td>know</td>
<td>Olivia has two small children</td>
<td>factL</td>
<td>4</td>
<td>NonProj</td>
<td>...</td>
<td>2</td>
<td>23</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>14.448983</td>
<td>30BUDKLTXDWSDQMUT8Z0U8OC3AM5EK</td>
<td>L</td>
<td>4L</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7733</td>
<td>297</td>
<td>5968</td>
<td>F</td>
<td>M</td>
<td>Jackson ran 10 miles</td>
<td>know</td>
<td>Jackson is obese</td>
<td>factL</td>
<td>13</td>
<td>NonProj</td>
<td>...</td>
<td>12</td>
<td>39</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>f</td>
<td>4.131933</td>
<td>345LHZDEDXT6O7WC5PQCJTCVB2P3U9</td>
<td>L</td>
<td>13L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7763</td>
<td>298</td>
<td>2195</td>
<td>M</td>
<td>M</td>
<td>Emma studied on Saturday morning</td>
<td>know</td>
<td>Emma is in law school</td>
<td>factH</td>
<td>3</td>
<td>NonProj</td>
<td>...</td>
<td>16</td>
<td>50</td>
<td>english</td>
<td>No</td>
<td>m</td>
<td>f</td>
<td>1.927500</td>
<td>3OXV7EAXLERLMW6B97S93NYF8G7367</td>
<td>H</td>
<td>3H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7776</td>
<td>299</td>
<td>12751</td>
<td>M</td>
<td>F</td>
<td>Josie went on vacation to France</td>
<td>know</td>
<td>Josie doesn&amp;quotechart have a passport</td>
<td>factL</td>
<td>2</td>
<td>NonProj</td>
<td>...</td>
<td>3</td>
<td>44</td>
<td>English</td>
<td>Yes</td>
<td>m</td>
<td>m</td>
<td>8.121600</td>
<td>3GA6AFUKOOP1JLQS5QJD0EN5HUOH3N</td>
<td>L</td>
<td>2L</td>
</tr>
</tbody>
</table>

<p>266 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="138">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i data_projection_know <span class="op">-</span>w <span class="dv">8</span> <span class="op">-</span>h <span class="dv">4</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>library(forcats)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(data_projection_know, aes(x<span class="op">=</span>response, fill<span class="op">=</span>itemType)) <span class="op">+</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>geom_histogram(color<span class="op">=</span><span class="st">"black"</span>, bins<span class="op">=</span><span class="dv">20</span>, position<span class="op">=</span><span class="st">"dodge"</span>) <span class="op">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>scale_fill_manual(name<span class="op">=</span><span class="st">"Intended Likelihood of Embedded Proposition"</span>, values<span class="op">=</span>c(<span class="st">"#133B6C"</span>, <span class="st">"#CD5400"</span>)) <span class="op">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>theme(axis.title.x<span class="op">=</span>element_blank(),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>      axis.text.y<span class="op">=</span>element_blank(),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>      axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>, hjust<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>      axis.ticks.y<span class="op">=</span>element_blank(),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>      legend.title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>      legend.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">16</span>),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>      legend.position<span class="op">=</span><span class="st">"bottom"</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"projection-example-distributions-know.png"</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><span class="math display">\[\begin{align*}
\rho^\text{(verb)}_v &amp;\sim \mathcal{N}(0, \sigma_\text{verb})\\
\rho^\text{(context)}_c &amp;\sim \mathcal{N}\left(\mu^\text{(context)}_c, \sigma^\text{(context)}_c\right)\\
\rho^\text{(subj-verb)}_s &amp;\sim \mathcal{N}(0, \sigma_\text{subj-verb})\\
\rho^\text{(subj-context)}_s &amp;\sim \mathcal{N}(0, \sigma_\text{subj-context})\\
\end{align*}\]</span></p>
<p>where each of the standard deviations are distributed exponential.</p>
<p><span class="math display">\[\begin{align*}
\sigma_\text{verb} &amp;\sim \text{Exponential}(1)\\
\sigma_\text{subj-verb} &amp;\sim \text{Exponential}(1)\\
\sigma_\text{subj-context} &amp;\sim \text{Exponential}(1)\\
\end{align*}\]</span></p>
<div class="cell" data-tags="[]" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>projection_model_stan_data_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/data-block.stan"</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(projection_model_stan_data_block_file, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">data</span> <span class="p">{</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">N_resp</span><span class="p">;</span>                                <span class="c1">// number of responses</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">N_verb</span><span class="p">;</span>                                <span class="c1">// number of verbs</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">N_context</span><span class="p">;</span>                             <span class="c1">// number of contexts</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">N_subj</span><span class="p">;</span>                                <span class="c1">// number of subjects</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_mean</span><span class="p">;</span>                           <span class="c1">// the verb means inferred from a previous model fit</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_std</span><span class="p">;</span>                            <span class="c1">// the verb standard deviations inferred from a previous model fit</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_mean</span><span class="p">;</span>                     <span class="c1">// the context means inferred from the norming data</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_std</span><span class="p">;</span>                      <span class="c1">// the context standard deviations inferred from the norming data</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">1</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="n">N_verb</span><span class="o">&gt;</span> <span class="n">verb</span><span class="p">[</span><span class="n">N_resp</span><span class="p">];</span>             <span class="c1">// verb corresponding to response n</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">1</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="n">N_context</span><span class="o">&gt;</span> <span class="n">context</span><span class="p">[</span><span class="n">N_resp</span><span class="p">];</span>       <span class="c1">// context corresponding to response n</span>
  <span class="kt">int</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">1</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="n">N_subj</span><span class="o">&gt;</span> <span class="n">subj</span><span class="p">[</span><span class="n">N_resp</span><span class="p">];</span>             <span class="c1">// subject corresponding to response n</span>
  <span class="kt">vector</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="mf">1</span><span class="o">&gt;</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">resp</span><span class="p">;</span>               <span class="c1">// bounded slider response   </span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="29">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> zeros, ones</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProjectionData(NormingData):</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    N_verb: <span class="bu">int</span>                           <span class="co"># number of verbs</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    verb: ndarray                         <span class="co"># verb corresponding to response n</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    verb_mean: ndarray                    <span class="co"># the verb means inferred from a previous model fit</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    verb_std: ndarray                     <span class="co"># the verb standard deviations inferred from a previous model fit</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    context_mean: ndarray                 <span class="co"># the context means inferred from the norming data</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    context_std: ndarray                  <span class="co"># the context standard deviations inferred from the norming data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="30">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>parameters_and_model_block_files <span class="op">=</span> {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"no_priors_fixed"</span>: <span class="st">"parameters-and-model-block.stan"</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"verb_priors_fixed"</span>: <span class="st">"parameters-and-model-block-verb-prior-fixed.stan"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"context_priors_fixed"</span>: <span class="st">"parameters-and-model-block-context-prior-fixed.stan"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"both_priors_fixed"</span>: <span class="st">"parameters-and-model-block-context-and-verb-priors-fixed.stan"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="31">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>projection_model_stan_parmeters_and_model_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/parameters-and-model-block/"</span>, parameters_and_model_block_files[<span class="st">"no_priors_fixed"</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(projection_model_stan_parmeters_and_model_block_file, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">parameters</span> <span class="p">{</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">verb_intercept_std</span><span class="p">;</span>                   <span class="c1">// the verb random intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_intercept_z</span><span class="p">;</span>                    <span class="c1">// the verb random intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">context_intercept_std</span><span class="p">;</span>                <span class="c1">// the context random intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept_z</span><span class="p">;</span>              <span class="c1">// the context random intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_verb_std</span><span class="p">;</span>              <span class="c1">// the subject random verb intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_verb_z</span><span class="p">;</span>               <span class="c1">// the subject random verb intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_context_std</span><span class="p">;</span>           <span class="c1">// the subject random context intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_context_z</span><span class="p">;</span>            <span class="c1">// the subject random context intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="mf">1</span><span class="o">&gt;</span> <span class="n">sigma</span><span class="p">;</span>                        <span class="c1">// the standard deviation of the likelihood</span>
<span class="p">}</span>

<span class="kn">transformed parameters</span> <span class="p">{</span>
  <span class="c1">// verb parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_intercept</span> <span class="o">=</span> <span class="n">verb_intercept_std</span> <span class="o">*</span> <span class="n">verb_intercept_z</span><span class="p">;</span>

  <span class="c1">// context parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept</span> <span class="o">=</span> <span class="n">context_intercept_std</span> <span class="o">*</span> <span class="n">context_intercept_z</span><span class="p">;</span>

  <span class="c1">// subject parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_verb</span> <span class="o">=</span> <span class="n">subj_intercept_verb_std</span> <span class="o">*</span> <span class="n">subj_intercept_verb_z</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_context</span> <span class="o">=</span> <span class="n">subj_intercept_context_std</span> <span class="o">*</span> <span class="n">subj_intercept_context_z</span><span class="p">;</span>

  <span class="c1">// log-likelihood</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">log_lik</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">verb_prob_by_resp</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">context_prob_by_resp</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">verb_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">verb_intercept</span><span class="p">[</span><span class="n">verb</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept_verb</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
    <span class="p">);</span>
    <span class="n">context_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">context_intercept</span><span class="p">[</span><span class="n">context</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept_context</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
    <span class="p">);</span>
    <span class="n">log_lik</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_lik_lpdf</span><span class="p">(</span>
      <span class="n">resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">|</span> <span class="n">verb_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">context_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">sigma</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kn">model</span> <span class="p">{</span>
  <span class="c1">// sample the verb intercepts</span>
  <span class="n">verb_intercept_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">verb_intercept_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="c1">// sample the context intercepts</span>
  <span class="n">context_intercept_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">context_intercept_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="c1">// sample the subject intercepts</span>
  <span class="n">subj_intercept_verb_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_verb_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="n">subj_intercept_context_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_context_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>
  
  <span class="c1">// sample the responses</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span>
    <span class="k">target +=</span> <span class="n">log_lik</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="32">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>projection_model_stan_parmeters_and_model_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/parameters-and-model-block/"</span>, parameters_and_model_block_files[<span class="st">"verb_priors_fixed"</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(projection_model_stan_parmeters_and_model_block_file, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">parameters</span> <span class="p">{</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_intercept_z</span><span class="p">;</span>                    <span class="c1">// the verb random intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">context_intercept_std</span><span class="p">;</span>                <span class="c1">// the context random intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept_z</span><span class="p">;</span>              <span class="c1">// the context random intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_verb_std</span><span class="p">;</span>              <span class="c1">// the subject random verb intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_verb_z</span><span class="p">;</span>               <span class="c1">// the subject random verb intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_context_std</span><span class="p">;</span>           <span class="c1">// the subject random context intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_context_z</span><span class="p">;</span>            <span class="c1">// the subject random context intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="mf">1</span><span class="o">&gt;</span> <span class="n">sigma</span><span class="p">;</span>                        <span class="c1">// the standard deviation of the likelihood</span>
<span class="p">}</span>

<span class="kn">transformed parameters</span> <span class="p">{</span>
  <span class="c1">// verb parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_intercept</span> <span class="o">=</span> <span class="n">verb_std</span> <span class="o">.*</span> <span class="n">verb_intercept_z</span> <span class="o">+</span> <span class="n">verb_mean</span><span class="p">;</span>

  <span class="c1">// context parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept</span> <span class="o">=</span> <span class="n">context_intercept_std</span> <span class="o">*</span> <span class="n">context_intercept_z</span><span class="p">;</span>

  <span class="c1">// subject parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_verb</span> <span class="o">=</span> <span class="n">subj_intercept_verb_std</span> <span class="o">*</span> <span class="n">subj_intercept_verb_z</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_context</span> <span class="o">=</span> <span class="n">subj_intercept_context_std</span> <span class="o">*</span> <span class="n">subj_intercept_context_z</span><span class="p">;</span>

  <span class="c1">// log-likelihood</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">log_lik</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">verb_prob_by_resp</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">context_prob_by_resp</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">verb_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">verb_intercept</span><span class="p">[</span><span class="n">verb</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept_verb</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
    <span class="p">);</span>
    <span class="n">context_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">context_intercept</span><span class="p">[</span><span class="n">context</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept_context</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
    <span class="p">);</span>
    <span class="n">log_lik</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_lik_lpdf</span><span class="p">(</span>
      <span class="n">resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">|</span> <span class="n">verb_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">context_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">sigma</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kn">model</span> <span class="p">{</span>
  <span class="c1">// sample the verb intercepts</span>
  <span class="n">verb_intercept_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="c1">// sample the context intercepts</span>
  <span class="n">context_intercept_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">context_intercept_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="c1">// sample the subject intercepts</span>
  <span class="n">subj_intercept_verb_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_verb_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="n">subj_intercept_context_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_context_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>
  
  <span class="c1">// sample the responses</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span>
    <span class="k">target +=</span> <span class="n">log_lik</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="33">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>projection_model_stan_parmeters_and_model_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/parameters-and-model-block/"</span>, parameters_and_model_block_files[<span class="st">"context_priors_fixed"</span>]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(projection_model_stan_parmeters_and_model_block_file, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">parameters</span> <span class="p">{</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">verb_intercept_std</span><span class="p">;</span>                   <span class="c1">// the verb random intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_intercept_z</span><span class="p">;</span>                    <span class="c1">// the verb random intercepts z-score</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept_z</span><span class="p">;</span>              <span class="c1">// the context random intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_verb_std</span><span class="p">;</span>              <span class="c1">// the subject random verb intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_verb_z</span><span class="p">;</span>               <span class="c1">// the subject random verb intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_context_std</span><span class="p">;</span>           <span class="c1">// the subject random context intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_context_z</span><span class="p">;</span>            <span class="c1">// the subject random context intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="mf">1</span><span class="o">&gt;</span> <span class="n">sigma</span><span class="p">;</span>                        <span class="c1">// the standard deviation of the likelihood</span>
<span class="p">}</span>

<span class="kn">transformed parameters</span> <span class="p">{</span>
  <span class="c1">// verb parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_intercept</span> <span class="o">=</span> <span class="n">verb_intercept_std</span> <span class="o">*</span> <span class="n">verb_intercept_z</span><span class="p">;</span>

  <span class="c1">// context parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept</span> <span class="o">=</span> <span class="n">context_std</span> <span class="o">.*</span> <span class="n">context_intercept_z</span> <span class="o">+</span> <span class="n">context_mean</span><span class="p">;</span>

  <span class="c1">// subject parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_verb</span> <span class="o">=</span> <span class="n">subj_intercept_verb_std</span> <span class="o">*</span> <span class="n">subj_intercept_verb_z</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_context</span> <span class="o">=</span> <span class="n">subj_intercept_context_std</span> <span class="o">*</span> <span class="n">subj_intercept_context_z</span><span class="p">;</span>

  <span class="c1">// log-likelihood</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">log_lik</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">verb_prob_by_resp</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">context_prob_by_resp</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">verb_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">verb_intercept</span><span class="p">[</span><span class="n">verb</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept_verb</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
    <span class="p">);</span>
    <span class="n">context_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">context_intercept</span><span class="p">[</span><span class="n">context</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept_context</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
    <span class="p">);</span>
    <span class="n">log_lik</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_lik_lpdf</span><span class="p">(</span>
      <span class="n">resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">|</span> <span class="n">verb_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">context_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">sigma</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kn">model</span> <span class="p">{</span>
  <span class="c1">// sample the verb intercepts</span>
  <span class="n">verb_intercept_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">verb_intercept_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="c1">// sample the context intercepts</span>
  <span class="n">context_intercept_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="c1">// sample the subject intercepts</span>
  <span class="n">subj_intercept_verb_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_verb_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="n">subj_intercept_context_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_context_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>
  
  <span class="c1">// sample the responses</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span>
    <span class="k">target +=</span> <span class="n">log_lik</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>projection_model_stan_parmeters_and_model_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/parameters-and-model-block/"</span>, parameters_and_model_block_files[<span class="st">"both_priors_fixed"</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(projection_model_stan_parmeters_and_model_block_file, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">parameters</span> <span class="p">{</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_intercept_z</span><span class="p">;</span>                    <span class="c1">// the verb random intercepts z-score</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept_z</span><span class="p">;</span>              <span class="c1">// the context random intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_verb_std</span><span class="p">;</span>              <span class="c1">// the subject random verb intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_verb_z</span><span class="p">;</span>               <span class="c1">// the subject random verb intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="o">&gt;</span> <span class="n">subj_intercept_context_std</span><span class="p">;</span>           <span class="c1">// the subject random context intercept standard deviation</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_context_z</span><span class="p">;</span>            <span class="c1">// the subject random context intercepts z-score</span>
  <span class="kt">real</span><span class="o">&lt;</span><span class="k">lower</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span><span class="k">upper</span><span class="p">=</span><span class="mf">1</span><span class="o">&gt;</span> <span class="n">sigma</span><span class="p">;</span>                        <span class="c1">// the standard deviation of the likelihood</span>
<span class="p">}</span>

<span class="kn">transformed parameters</span> <span class="p">{</span>
  <span class="c1">// verb parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_intercept</span> <span class="o">=</span> <span class="n">verb_std</span> <span class="o">.*</span> <span class="n">verb_intercept_z</span> <span class="o">+</span> <span class="n">verb_mean</span><span class="p">;</span>

  <span class="c1">// context parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_intercept</span> <span class="o">=</span> <span class="n">context_std</span> <span class="o">.*</span> <span class="n">context_intercept_z</span> <span class="o">+</span> <span class="n">context_mean</span><span class="p">;</span>

  <span class="c1">// subject parameters</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_verb</span> <span class="o">=</span> <span class="n">subj_intercept_verb_std</span> <span class="o">*</span> <span class="n">subj_intercept_verb_z</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_subj</span><span class="p">]</span> <span class="n">subj_intercept_context</span> <span class="o">=</span> <span class="n">subj_intercept_context_std</span> <span class="o">*</span> <span class="n">subj_intercept_context_z</span><span class="p">;</span>

  <span class="c1">// log-likelihood</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">log_lik</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">verb_prob_by_resp</span><span class="p">;</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_resp</span><span class="p">]</span> <span class="n">context_prob_by_resp</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">verb_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">verb_intercept</span><span class="p">[</span><span class="n">verb</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept_verb</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
    <span class="p">);</span>
    <span class="n">context_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
      <span class="n">context_intercept</span><span class="p">[</span><span class="n">context</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">+</span> <span class="n">subj_intercept_context</span><span class="p">[</span><span class="n">subj</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
    <span class="p">);</span>
    <span class="n">log_lik</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_lik_lpdf</span><span class="p">(</span>
      <span class="n">resp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">|</span> <span class="n">verb_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">context_prob_by_resp</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">sigma</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kn">model</span> <span class="p">{</span>
  <span class="c1">// sample the verb intercepts</span>
  <span class="n">verb_intercept_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="c1">// sample the context intercepts</span>
  <span class="n">context_intercept_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="c1">// sample the subject intercepts</span>
  <span class="n">subj_intercept_verb_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_verb_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>

  <span class="n">subj_intercept_context_std</span> <span class="o">~</span><span class="w"> </span><span class="nb">exponential</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="n">subj_intercept_context_z</span> <span class="o">~</span><span class="w"> </span><span class="nb">std_normal</span><span class="p">();</span>
  
  <span class="c1">// sample the responses</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="k">in</span> <span class="mf">1</span><span class="o">:</span><span class="n">N_resp</span><span class="p">)</span>
    <span class="k">target +=</span> <span class="n">log_lik</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="35">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>projection_model_stan_generated_quantities_file <span class="op">=</span> os.path.join(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/generated-quantities-block.stan"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(projection_model_stan_generated_quantities_file, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">generated quantities</span> <span class="p">{</span>
  <span class="kt">vector</span><span class="p">[</span><span class="n">N_verb</span><span class="p">]</span> <span class="n">verb_prob</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
    <span class="n">verb_intercept</span>
  <span class="p">);</span>

  <span class="kt">vector</span><span class="p">[</span><span class="n">N_context</span><span class="p">]</span> <span class="n">context_prob</span> <span class="o">=</span> <span class="nb">inv_logit</span><span class="p">(</span>
    <span class="n">context_intercept</span>
  <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="36">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Union</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProjectionModel(StanModel):</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    stan_data_block_file <span class="op">=</span> projection_model_stan_data_block_file</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    stan_generated_quantities_block_file <span class="op">=</span> projection_model_stan_generated_quantities_file</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    data_class <span class="op">=</span> ProjectionData</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, prior_model: Optional[Union[NormingModel, <span class="st">'ProjectionModel'</span>]] <span class="op">=</span> <span class="va">None</span>, use_context_prior: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>):</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prior_model <span class="op">=</span> prior_model</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.use_context_priors <span class="op">=</span> use_context_prior <span class="kw">and</span> prior_model <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.use_verb_priors <span class="op">=</span> <span class="bu">hasattr</span>(</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>            prior_model, <span class="st">"verb_posterior_estimates"</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.use_context_priors <span class="kw">and</span> <span class="va">self</span>.use_verb_priors:</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Model initialized with context- and verb-specific priors derived "</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"from context- and verb-specific posteriors from prior_model."</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.context_hash_map <span class="op">=</span> prior_model.context_hash_map</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.verb_hash_map <span class="op">=</span> prior_model.verb_hash_map</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.stan_parameters_and_model_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>                model_dir, </span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">"projection-model/parameters-and-model-block/"</span>, </span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>                parameters_and_model_block_files[<span class="st">"both_priors_fixed"</span>]</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="va">self</span>.use_context_priors:</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Model initialized with context-specific priors derived "</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"from context-specific posteriors from prior_model."</span>)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.context_hash_map <span class="op">=</span> prior_model.context_hash_map</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.stan_parameters_and_model_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>                model_dir, </span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">"projection-model/parameters-and-model-block/"</span>, </span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>                parameters_and_model_block_files[<span class="st">"context_priors_fixed"</span>]</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="va">self</span>.use_verb_priors:</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Model initialized with verb-specific priors derived "</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"from verb-specific posteriors from prior_model."</span>)</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.verb_hash_map <span class="op">=</span> prior_model.verb_hash_map</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.stan_parameters_and_model_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>                model_dir, </span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>                <span class="st">"projection-model/parameters-and-model-block/"</span>, </span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>                parameters_and_model_block_files[<span class="st">"verb_priors_fixed"</span>]</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.stan_parameters_and_model_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>                model_dir, </span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">"projection-model/parameters-and-model-block/"</span>, </span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>                parameters_and_model_block_files[<span class="st">"no_priors_fixed"</span>]</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._write_stan_file()</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _write_stan_file(<span class="va">self</span>):</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>        functions_block <span class="op">=</span> <span class="bu">open</span>(<span class="va">self</span>.stan_functions_block_file, <span class="st">"r"</span>).read()</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>        data_block <span class="op">=</span> <span class="bu">open</span>(<span class="va">self</span>.stan_data_block_file, <span class="st">"r"</span>).read()</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>        parameters_and_model_block <span class="op">=</span> <span class="bu">open</span>(<span class="va">self</span>.stan_parameters_and_model_block_file, <span class="st">"r"</span>).read()</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>        generated_quantities_block <span class="op">=</span> <span class="bu">open</span>(<span class="va">self</span>.stan_generated_quantities_block_file, <span class="st">"r"</span>).read()</span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Writing STAN file to </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>stan_file<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.stan_file, <span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>            f.write(functions_block<span class="op">+</span><span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>            f.write(data_block<span class="op">+</span><span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>            f.write(parameters_and_model_block<span class="op">+</span><span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>            f.write(generated_quantities_block)</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractproperty</span></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> stan_functions_block_file(<span class="va">self</span>):</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">NotImplementedError</span></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_context_info(<span class="va">self</span>, data: pd.DataFrame):</span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(<span class="va">self</span>.prior_model, <span class="st">"context_info"</span>):</span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.context_info <span class="op">=</span> <span class="va">self</span>.prior_model.context_info</span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>            data[<span class="st">"prompt"</span>] <span class="op">=</span> data[<span class="st">"content"</span>]</span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a>            NormingModel.construct_context_info(<span class="va">self</span>, data)</span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_model_data(<span class="va">self</span>, data: pd.DataFrame):</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_data <span class="op">=</span> NormingModel.construct_model_data(<span class="va">self</span>, data)</span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(<span class="va">self</span>, <span class="st">"verb_hash_map"</span>):</span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a>            _, verb_hashed <span class="op">=</span> hash_series(data.verb, <span class="va">self</span>.verb_hash_map)</span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.verb_hash_map, verb_hashed <span class="op">=</span> hash_series(data.verb)</span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.coords.update({</span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">"verb"</span>: <span class="va">self</span>.verb_hash_map</span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dims.update({</span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">"verb_intercept"</span>: [<span class="st">"verb"</span>],</span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">"verb_prob"</span>: [<span class="st">"verb"</span>]</span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_data.update({</span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a>            <span class="st">"N_verb"</span>: <span class="va">self</span>.verb_hash_map.shape[<span class="dv">0</span>],</span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a>            <span class="st">"verb"</span>: verb_hashed</span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.use_context_priors:</span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model_data.update({</span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a>                <span class="st">"context_mean"</span>: <span class="va">self</span>.context_prior_estimates.context_mean.values,</span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a>                <span class="st">"context_std"</span>: <span class="va">self</span>.context_prior_estimates.context_std.values</span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model_data.update({</span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a>                <span class="st">"context_mean"</span>: zeros(<span class="va">self</span>.model_data[<span class="st">"N_context"</span>]),</span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a>                <span class="st">"context_std"</span>: ones(<span class="va">self</span>.model_data[<span class="st">"N_context"</span>]),</span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.use_verb_priors:</span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model_data.update({</span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a>                <span class="st">"verb_mean"</span>: <span class="va">self</span>.verb_prior_estimates.verb_mean.values,</span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a>                <span class="st">"verb_std"</span>: <span class="va">self</span>.verb_prior_estimates.verb_std.values,</span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model_data.update({</span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a>                <span class="st">"verb_mean"</span>: zeros(<span class="va">self</span>.model_data[<span class="st">"N_verb"</span>]),</span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a>                <span class="st">"verb_std"</span>: ones(<span class="va">self</span>.model_data[<span class="st">"N_verb"</span>]),</span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.model_data</span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> context_prior_estimates(<span class="va">self</span>):</span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.use_context_priors:</span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.prior_model.context_posterior_estimates</span>
<span id="cb45-137"><a href="#cb45-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-138"><a href="#cb45-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">AttributeError</span>(<span class="st">"no prior_model supplied for context priors"</span>)</span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-140"><a href="#cb45-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb45-141"><a href="#cb45-141" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> context_posterior_estimates(<span class="va">self</span>):</span>
<span id="cb45-142"><a href="#cb45-142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.fit_type <span class="op">==</span> FitType.SAMPLE:</span>
<span id="cb45-143"><a href="#cb45-143" aria-hidden="true" tabindex="-1"></a>            context_intercept_samples <span class="op">=</span> <span class="va">self</span>.raw_model_fit.stan_variable(<span class="st">"context_intercept"</span>)</span>
<span id="cb45-144"><a href="#cb45-144" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-145"><a href="#cb45-145" aria-hidden="true" tabindex="-1"></a>            params <span class="op">=</span> []</span>
<span id="cb45-146"><a href="#cb45-146" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-147"><a href="#cb45-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(context_intercept_samples.shape[<span class="dv">1</span>]):</span>
<span id="cb45-148"><a href="#cb45-148" aria-hidden="true" tabindex="-1"></a>                mu, sigma <span class="op">=</span> norm.fit(context_intercept_samples[:,i])</span>
<span id="cb45-149"><a href="#cb45-149" aria-hidden="true" tabindex="-1"></a>                context <span class="op">=</span> <span class="va">self</span>.context_hash_map[i]</span>
<span id="cb45-150"><a href="#cb45-150" aria-hidden="true" tabindex="-1"></a>                params.append([context, mu, sigma])</span>
<span id="cb45-151"><a href="#cb45-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-152"><a href="#cb45-152" aria-hidden="true" tabindex="-1"></a>            params_df <span class="op">=</span> pd.DataFrame(params, columns<span class="op">=</span>[<span class="st">"context"</span>, <span class="st">"context_mean"</span>, <span class="st">"context_std"</span>])</span>
<span id="cb45-153"><a href="#cb45-153" aria-hidden="true" tabindex="-1"></a>            params_df[<span class="st">"order"</span>] <span class="op">=</span> params_df.index</span>
<span id="cb45-154"><a href="#cb45-154" aria-hidden="true" tabindex="-1"></a>            params_df <span class="op">=</span> pd.merge(params_df, <span class="va">self</span>.context_info).sort_values(<span class="st">"order"</span>)</span>
<span id="cb45-155"><a href="#cb45-155" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-156"><a href="#cb45-156" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> params_df[[<span class="st">"fact"</span>, <span class="st">"context"</span>, <span class="st">"prompt"</span>, <span class="st">"context_mean"</span>, <span class="st">"context_std"</span>, <span class="st">"order"</span>]]</span>
<span id="cb45-157"><a href="#cb45-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-158"><a href="#cb45-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">NotImplementedError</span></span>
<span id="cb45-159"><a href="#cb45-159" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-160"><a href="#cb45-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb45-161"><a href="#cb45-161" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> verb_prior_estimates(<span class="va">self</span>):</span>
<span id="cb45-162"><a href="#cb45-162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.use_verb_priors:</span>
<span id="cb45-163"><a href="#cb45-163" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.prior_model.verb_posterior_estimates</span>
<span id="cb45-164"><a href="#cb45-164" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-165"><a href="#cb45-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">AttributeError</span>(<span class="st">"prior_model must have verb_posterior_estimates"</span>)</span>
<span id="cb45-166"><a href="#cb45-166" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-167"><a href="#cb45-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb45-168"><a href="#cb45-168" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> verb_posterior_estimates(<span class="va">self</span>):</span>
<span id="cb45-169"><a href="#cb45-169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.fit_type <span class="op">==</span> FitType.SAMPLE:</span>
<span id="cb45-170"><a href="#cb45-170" aria-hidden="true" tabindex="-1"></a>            verb_intercept_samples <span class="op">=</span> <span class="va">self</span>.raw_model_fit.stan_variable(<span class="st">"verb_intercept"</span>)</span>
<span id="cb45-171"><a href="#cb45-171" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-172"><a href="#cb45-172" aria-hidden="true" tabindex="-1"></a>            params <span class="op">=</span> []</span>
<span id="cb45-173"><a href="#cb45-173" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-174"><a href="#cb45-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(verb_intercept_samples.shape[<span class="dv">1</span>]):</span>
<span id="cb45-175"><a href="#cb45-175" aria-hidden="true" tabindex="-1"></a>                mu, sigma <span class="op">=</span> norm.fit(verb_intercept_samples[:,i])</span>
<span id="cb45-176"><a href="#cb45-176" aria-hidden="true" tabindex="-1"></a>                verb <span class="op">=</span> <span class="va">self</span>.verb_hash_map[i]</span>
<span id="cb45-177"><a href="#cb45-177" aria-hidden="true" tabindex="-1"></a>                params.append([verb, mu, sigma])</span>
<span id="cb45-178"><a href="#cb45-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-179"><a href="#cb45-179" aria-hidden="true" tabindex="-1"></a>            params_df <span class="op">=</span> pd.DataFrame(params, columns<span class="op">=</span>[<span class="st">"verb"</span>, <span class="st">"verb_mean"</span>, <span class="st">"verb_std"</span>])</span>
<span id="cb45-180"><a href="#cb45-180" aria-hidden="true" tabindex="-1"></a>            params_df[<span class="st">"order"</span>] <span class="op">=</span> params_df.index</span>
<span id="cb45-181"><a href="#cb45-181" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-182"><a href="#cb45-182" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> params_df</span>
<span id="cb45-183"><a href="#cb45-183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-184"><a href="#cb45-184" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">NotImplementedError</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\begin{align*} &amp;c ∼ \texttt{JDS}
&amp;p ∼ \texttt{knowsJDS} \ &amp;τₚ ∼ \texttt{Bernoulli}(p) \ &amp;η ( τ_c ∼ \texttt{Bernoulli}(c); η(τₚ ∨ τ_c) ) \end{align*}\]</span></p>
<div class="cell" data-tags="[]" data-execution_count="37">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FullyDiscreteProjectionModel(ProjectionModel):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    stan_functions_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>        model_dir, <span class="st">"projection-model/fully-discrete/fully-discrete-likelihoods.stan"</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    stan_file <span class="op">=</span> os.path.join(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        model_dir, <span class="st">"projection-model/fully-discrete/fully-discrete-model.stan"</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="38">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fully_discrete_projection_model <span class="op">=</span> FullyDiscreteProjectionModel(norming_model)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>fully_discrete_projection_model.fit(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    data_projection, iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>16:58:32 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
16:58:45 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
16:58:45 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
16:58:45 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 29, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 30, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 31, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o

16:58:45 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
16:58:57 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
16:58:57 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
16:58:57 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 29, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 30, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 31, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o

16:58:57 - cmdstanpy - INFO - Chain [1] start processing
16:58:58 - cmdstanpy - INFO - Chain [1] done processing
16:58:58 - cmdstanpy - INFO - CmdStan start processing
17:04:35 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with context-specific priors derived from context-specific posteriors from prior_model.
Writing STAN file to models/projection-model/fully-discrete/fully-discrete-model.stan...
Fitting model by sampling...
Initializing sampling at MAP...
Writing STAN file to models/projection-model/fully-discrete/fully-discrete-model.stan...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0021f70a687c41a0acdfef35840cb5f9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2c2d42dfd017419b9b3fd668b3c81cf9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"80149a5203ce4121a95fc35047d73fd5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a288c67f615a4f0790f99c2807a50282","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>&lt;__main__.FullyDiscreteProjectionModel at 0xffff3b324a60&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="39">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fully_discrete_projection_model.raw_model_fit.diagnose())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing csv files: /tmp/tmp_c0tivx9/fully-discrete-modelnkibo_je/fully-discrete-model-20230528165858_1.csv, /tmp/tmp_c0tivx9/fully-discrete-modelnkibo_je/fully-discrete-model-20230528165858_2.csv, /tmp/tmp_c0tivx9/fully-discrete-modelnkibo_je/fully-discrete-model-20230528165858_3.csv, /tmp/tmp_c0tivx9/fully-discrete-modelnkibo_je/fully-discrete-model-20230528165858_4.csv

Checking sampler transitions treedepth.
Treedepth satisfactory for all transitions.

Checking sampler transitions for divergences.
No divergent transitions found.

Checking E-BFMI - sampler transitions HMC potential energy.
E-BFMI satisfactory.

Effective sample size satisfactory.

Split R-hat values satisfactory all parameters.

Processing complete, no problems detected.
</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    fully_discrete_projection_model.model_fit,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"verb_prob"</span>, <span class="st">"context_prob"</span>, <span class="st">"sigma"</span>],</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">12</span>),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-46-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="41">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    fully_discrete_projection_model.model_fit,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"verb_intercept_std"</span>, <span class="st">"context_intercept_std"</span>],</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">2</span>),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-47-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="42">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext rpy2.ipython</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The rpy2.ipython extension is already loaded. To reload it, use:
  %reload_ext rpy2.ipython</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="43">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i data_projection</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>head(data_projection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  workerid   rt subjectGender speakerGender                          content
3        0 3495             M             M     Emily bought a car yesterday
4        0 3866             F             M                  Frank got a cat
5        0 2983             F             F           Charley speaks Spanish
6        0 4669             F             F                Jon walks to work
7        0 3847             M             F Mia drank 2 cocktails last night
8        0 3052             F             F              Julian dances salsa
           verb                              fact fact_type contentNr
3     establish  Emily has been saving for a year     factH         8
4         prove     Frank has always wanted a pet     factH        12
5        reveal           Charley lives in Mexico     factH        20
6       confirm Jon lives 10 miles away from work     factL        19
7   acknowledge          Mia is a college student     factH         6
8 be_right_that                   Julian is Cuban     factH        18
  trigger_class response slide_number_in_experiment age language assess
3       NonProj     0.61                          4  38  english    Yes
4             C     0.72                          5  38  english    Yes
5       NonProj     0.92                          6  38  english    Yes
6             C     0.42                          7  38  english    Yes
7             C     0.81                          8  38  english    Yes
8             C     0.33                          9  38  english    Yes
  american gender comments Answer.time_in_minutes
3        m      m     &lt;NA&gt;                 2.0626
4        m      m     &lt;NA&gt;                 2.0626
5        m      m     &lt;NA&gt;                 2.0626
6        m      m     &lt;NA&gt;                 2.0626
7        m      m     &lt;NA&gt;                 2.0626
8        m      m     &lt;NA&gt;                 2.0626
                    assignmentid item                           prompt
3 3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3   8H     Emily bought a car yesterday
4 3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3  12H                  Frank got a cat
5 3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3  20H           Charley speaks Spanish
6 3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3  19L                Jon walks to work
7 3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3   6H Mia drank 2 cocktails last night
8 3PIWWX1FJJ78V5N7WBELSYK9QJBJJ3  18H              Julian dances salsa</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/rpy2/robjects/pandas2ri.py:65: UserWarning: Error while trying to convert the column "comments". Fall back to string conversion. The error is: Series can only be of one type, or None (and here we have &lt;class 'float'&gt; and &lt;class 'str'&gt;). If happening with a pandas DataFrame the method infer_objects() will normalize data types before conversion.
  warnings.warn('Error while trying to convert '</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="44">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>verb_discrete_model_functions_block <span class="op">=</span> os.path.join(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/verb-discrete/verb-discrete-likelihoods.stan"</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(verb_discrete_model_functions_block, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">functions</span> <span class="p">{</span>
  <span class="kt">real</span> <span class="n">truncated_normal_lpdf</span><span class="p">(</span><span class="kt">real</span> <span class="n">x</span><span class="p">,</span> <span class="kt">real</span> <span class="n">mu</span><span class="p">,</span> <span class="kt">real</span> <span class="n">sigma</span><span class="p">,</span> <span class="kt">real</span> <span class="n">a</span><span class="p">,</span> <span class="kt">real</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">normal_lpdf</span><span class="p">(</span><span class="n">x</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> 
           <span class="nb">log_diff_exp</span><span class="p">(</span><span class="nb">normal_lcdf</span><span class="p">(</span><span class="n">b</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> 
                        <span class="nb">normal_lcdf</span><span class="p">(</span><span class="n">a</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="kt">real</span> <span class="n">log_lik_lpdf</span><span class="p">(</span><span class="kt">real</span> <span class="n">resp</span><span class="p">,</span> <span class="kt">real</span> <span class="n">verb_prob</span><span class="p">,</span> <span class="kt">real</span> <span class="n">context_prob</span><span class="p">,</span> <span class="kt">real</span> <span class="n">sigma</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">log_mix</span><span class="p">(</span>
      <span class="n">verb_prob</span><span class="p">,</span>
      <span class="n">truncated_normal_lpdf</span><span class="p">(</span><span class="n">resp</span> <span class="p">|</span> <span class="mf">1</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">),</span>
      <span class="n">truncated_normal_lpdf</span><span class="p">(</span><span class="n">resp</span> <span class="p">|</span> <span class="n">context_prob</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="45">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> VerbDiscreteProjectionModel(ProjectionModel):</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    stan_functions_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>        model_dir, <span class="st">"projection-model/verb-discrete/verb-discrete-likelihoods.stan"</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    stan_file <span class="op">=</span> os.path.join(</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        model_dir, <span class="st">"projection-model/verb-discrete/verb-discrete-model.stan"</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="46">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>verb_discrete_projection_model <span class="op">=</span> VerbDiscreteProjectionModel(norming_model)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>verb_discrete_projection_model.fit(</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    data_projection, iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>17:06:25 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
17:06:37 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
17:06:37 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
17:06:37 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o

17:06:37 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
17:06:48 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
17:06:48 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
17:06:48 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o

17:06:48 - cmdstanpy - INFO - Chain [1] start processing
17:06:48 - cmdstanpy - INFO - Chain [1] done processing
17:06:48 - cmdstanpy - INFO - CmdStan start processing
17:15:33 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with context-specific priors derived from context-specific posteriors from prior_model.
Writing STAN file to models/projection-model/verb-discrete/verb-discrete-model.stan...
Fitting model by sampling...
Initializing sampling at MAP...
Writing STAN file to models/projection-model/verb-discrete/verb-discrete-model.stan...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2f8a4bde17fb4f59b7615316011023cc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"68e5518778ee4349a56ce4da91359078","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4267e1700afd498f9c8290842075dcbc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9df3a10b690341fd84ed52f619cee10c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>&lt;__main__.VerbDiscreteProjectionModel at 0xffff5449b700&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="47">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(verb_discrete_projection_model.raw_model_fit.diagnose())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing csv files: /tmp/tmp_c0tivx9/verb-discrete-modelq074ppst/verb-discrete-model-20230528170648_1.csv, /tmp/tmp_c0tivx9/verb-discrete-modelq074ppst/verb-discrete-model-20230528170648_2.csv, /tmp/tmp_c0tivx9/verb-discrete-modelq074ppst/verb-discrete-model-20230528170648_3.csv, /tmp/tmp_c0tivx9/verb-discrete-modelq074ppst/verb-discrete-model-20230528170648_4.csv

Checking sampler transitions treedepth.
Treedepth satisfactory for all transitions.

Checking sampler transitions for divergences.
No divergent transitions found.

Checking E-BFMI - sampler transitions HMC potential energy.
E-BFMI satisfactory.

Effective sample size satisfactory.

The following parameters had split R-hat greater than 1.05:
  log_lik[1762], log_lik[1766], verb_prob_by_resp[1761], verb_prob_by_resp[1764], verb_prob_by_resp[1772], verb_prob_by_resp[1776], context_prob_by_resp[1762], context_prob_by_resp[1765], context_prob_by_resp[1766], context_prob_by_resp[1769], context_prob_by_resp[1771], context_prob_by_resp[1773], context_prob_by_resp[1774], context_prob_by_resp[1775], context_prob_by_resp[1776], context_prob_by_resp[1779]
Such high values indicate incomplete mixing and biased estimation.
You should consider regularizating your model with additional prior information or a more effective parameterization.

Processing complete.
</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="48">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    verb_discrete_projection_model.model_fit,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"verb_prob"</span>, <span class="st">"context_prob"</span>, <span class="st">"sigma"</span>],</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">12</span>),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-54-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="50">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>context_discrete_model_noncentered_path <span class="op">=</span> os.path.join(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/context-discrete/context-discrete-likelihoods.stan"</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(context_discrete_model_noncentered_path, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">functions</span> <span class="p">{</span>
  <span class="kt">real</span> <span class="n">truncated_normal_lpdf</span><span class="p">(</span><span class="kt">real</span> <span class="n">x</span><span class="p">,</span> <span class="kt">real</span> <span class="n">mu</span><span class="p">,</span> <span class="kt">real</span> <span class="n">sigma</span><span class="p">,</span> <span class="kt">real</span> <span class="n">a</span><span class="p">,</span> <span class="kt">real</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">normal_lpdf</span><span class="p">(</span><span class="n">x</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> 
           <span class="nb">log_diff_exp</span><span class="p">(</span><span class="nb">normal_lcdf</span><span class="p">(</span><span class="n">b</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> 
                        <span class="nb">normal_lcdf</span><span class="p">(</span><span class="n">a</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="kt">real</span> <span class="n">log_lik_lpdf</span><span class="p">(</span><span class="kt">real</span> <span class="n">resp</span><span class="p">,</span> <span class="kt">real</span> <span class="n">verb_prob</span><span class="p">,</span> <span class="kt">real</span> <span class="n">context_prob</span><span class="p">,</span> <span class="kt">real</span> <span class="n">sigma</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">log_mix</span><span class="p">(</span>
      <span class="n">context_prob</span><span class="p">,</span>
      <span class="n">truncated_normal_lpdf</span><span class="p">(</span><span class="n">resp</span> <span class="p">|</span> <span class="mf">1</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">),</span>
      <span class="n">truncated_normal_lpdf</span><span class="p">(</span><span class="n">resp</span> <span class="p">|</span> <span class="n">verb_prob</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="51">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ContextDiscreteProjectionModel(ProjectionModel):</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    stan_functions_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        model_dir, <span class="st">"projection-model/context-discrete/context-discrete-likelihoods.stan"</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    stan_file <span class="op">=</span> os.path.join(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        model_dir, <span class="st">"projection-model/context-discrete/context-discrete-model.stan"</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="54">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>context_discrete_projection_model <span class="op">=</span> ContextDiscreteProjectionModel(norming_model)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>context_discrete_projection_model.fit(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    data_projection, iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>17:21:47 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
17:21:58 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
17:21:58 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
17:21:58 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o

17:21:58 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
17:22:10 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
17:22:10 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
17:22:10 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o

17:22:10 - cmdstanpy - INFO - Chain [1] start processing
17:22:10 - cmdstanpy - INFO - Chain [1] done processing
17:22:10 - cmdstanpy - INFO - CmdStan start processing
17:40:00 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with context-specific priors derived from context-specific posteriors from prior_model.
Writing STAN file to models/projection-model/context-discrete/context-discrete-model.stan...
Fitting model by sampling...
Initializing sampling at MAP...
Writing STAN file to models/projection-model/context-discrete/context-discrete-model.stan...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fdac0662851a428fad6353024e233a3a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0ad6225ce3e744f9bcaaa656e3f0c549","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e4d6a53c23c14e8c93b718725ce03b98","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b80a933c080d4fdab03fc3399af91b21","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>&lt;__main__.ContextDiscreteProjectionModel at 0xffff3bcc9120&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="55">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(context_discrete_projection_model.raw_model_fit.diagnose())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing csv files: /tmp/tmp_c0tivx9/context-discrete-modela8ccfpxw/context-discrete-model-20230528172210_1.csv, /tmp/tmp_c0tivx9/context-discrete-modela8ccfpxw/context-discrete-model-20230528172210_2.csv, /tmp/tmp_c0tivx9/context-discrete-modela8ccfpxw/context-discrete-model-20230528172210_3.csv, /tmp/tmp_c0tivx9/context-discrete-modela8ccfpxw/context-discrete-model-20230528172210_4.csv

Checking sampler transitions treedepth.
Treedepth satisfactory for all transitions.

Checking sampler transitions for divergences.
No divergent transitions found.

Checking E-BFMI - sampler transitions HMC potential energy.
E-BFMI satisfactory.

The following parameters had fewer than 0.001 effective draws per transition:
  subj_intercept_verb_z[66], subj_intercept_verb_z[153], subj_intercept_context_z[66], subj_intercept_context_z[153], subj_intercept_verb[66], subj_intercept_verb[153], subj_intercept_context[66], subj_intercept_context[153], log_lik[1301], log_lik[1302], log_lik[1303], log_lik[1304], log_lik[1305], log_lik[1306], log_lik[1307], log_lik[1308], log_lik[1309], log_lik[1313], log_lik[1315], log_lik[1316], log_lik[1317], log_lik[1319], log_lik[1320], log_lik[3041], log_lik[3042], log_lik[3043], log_lik[3045], log_lik[3047], log_lik[3048], log_lik[3049], log_lik[3050], log_lik[3051], log_lik[3052], log_lik[3053], log_lik[3054], log_lik[3055], log_lik[3056], log_lik[3057], log_lik[3059], verb_prob_by_resp[1301], verb_prob_by_resp[1302], verb_prob_by_resp[1303], verb_prob_by_resp[1304], verb_prob_by_resp[1305], verb_prob_by_resp[1306], verb_prob_by_resp[1307], verb_prob_by_resp[1309], verb_prob_by_resp[1311], verb_prob_by_resp[1313], verb_prob_by_resp[1315], verb_prob_by_resp[1317], verb_prob_by_resp[1319], verb_prob_by_resp[1320], verb_prob_by_resp[3041], verb_prob_by_resp[3042], verb_prob_by_resp[3047], verb_prob_by_resp[3048], verb_prob_by_resp[3049], verb_prob_by_resp[3051], verb_prob_by_resp[3052], verb_prob_by_resp[3053], verb_prob_by_resp[3054], verb_prob_by_resp[3055], verb_prob_by_resp[3056], verb_prob_by_resp[3057], verb_prob_by_resp[3058], context_prob_by_resp[1301], context_prob_by_resp[1302], context_prob_by_resp[1303], context_prob_by_resp[1304], context_prob_by_resp[1305], context_prob_by_resp[1306], context_prob_by_resp[1307], context_prob_by_resp[1308], context_prob_by_resp[1309], context_prob_by_resp[1310], context_prob_by_resp[1311], context_prob_by_resp[1312], context_prob_by_resp[1313], context_prob_by_resp[1314], context_prob_by_resp[1315], context_prob_by_resp[1316], context_prob_by_resp[1317], context_prob_by_resp[1318], context_prob_by_resp[1319], context_prob_by_resp[1320], context_prob_by_resp[3041], context_prob_by_resp[3042], context_prob_by_resp[3043], context_prob_by_resp[3044], context_prob_by_resp[3045], context_prob_by_resp[3046], context_prob_by_resp[3047], context_prob_by_resp[3048], context_prob_by_resp[3049], context_prob_by_resp[3050], context_prob_by_resp[3051], context_prob_by_resp[3052], context_prob_by_resp[3053], context_prob_by_resp[3054], context_prob_by_resp[3055], context_prob_by_resp[3056], context_prob_by_resp[3057], context_prob_by_resp[3058], context_prob_by_resp[3059], context_prob_by_resp[3060]
Such low values indicate that the effective sample size estimators may be biased high and actual performance may be substantially lower than quoted.

The following parameters had split R-hat greater than 1.05:
  subj_intercept_verb_z[66], subj_intercept_verb_z[153], subj_intercept_context_z[66], subj_intercept_context_z[153], subj_intercept_verb[66], subj_intercept_verb[153], subj_intercept_context[66], subj_intercept_context[153], log_lik[1301], log_lik[1302], log_lik[1303], log_lik[1304], log_lik[1305], log_lik[1306], log_lik[1307], log_lik[1308], log_lik[1309], log_lik[1310], log_lik[1313], log_lik[1314], log_lik[1315], log_lik[1316], log_lik[1317], log_lik[1319], log_lik[1320], log_lik[3041], log_lik[3042], log_lik[3043], log_lik[3044], log_lik[3045], log_lik[3047], log_lik[3048], log_lik[3049], log_lik[3050], log_lik[3051], log_lik[3052], log_lik[3053], log_lik[3054], log_lik[3055], log_lik[3056], log_lik[3057], log_lik[3058], log_lik[3059], log_lik[3140], verb_prob_by_resp[1301], verb_prob_by_resp[1302], verb_prob_by_resp[1303], verb_prob_by_resp[1304], verb_prob_by_resp[1305], verb_prob_by_resp[1306], verb_prob_by_resp[1307], verb_prob_by_resp[1309], verb_prob_by_resp[1311], verb_prob_by_resp[1312], verb_prob_by_resp[1313], verb_prob_by_resp[1315], verb_prob_by_resp[1317], verb_prob_by_resp[1318], verb_prob_by_resp[1319], verb_prob_by_resp[1320], verb_prob_by_resp[3041], verb_prob_by_resp[3042], verb_prob_by_resp[3044], verb_prob_by_resp[3046], verb_prob_by_resp[3047], verb_prob_by_resp[3048], verb_prob_by_resp[3049], verb_prob_by_resp[3051], verb_prob_by_resp[3052], verb_prob_by_resp[3053], verb_prob_by_resp[3054], verb_prob_by_resp[3055], verb_prob_by_resp[3056], verb_prob_by_resp[3057], verb_prob_by_resp[3058], verb_prob_by_resp[3060], verb_prob_by_resp[3124], verb_prob_by_resp[3129], verb_prob_by_resp[3131], verb_prob_by_resp[3132], verb_prob_by_resp[3134], verb_prob_by_resp[3136], verb_prob_by_resp[3137], verb_prob_by_resp[3140], context_prob_by_resp[1301], context_prob_by_resp[1302], context_prob_by_resp[1303], context_prob_by_resp[1304], context_prob_by_resp[1305], context_prob_by_resp[1306], context_prob_by_resp[1307], context_prob_by_resp[1308], context_prob_by_resp[1309], context_prob_by_resp[1310], context_prob_by_resp[1311], context_prob_by_resp[1312], context_prob_by_resp[1313], context_prob_by_resp[1314], context_prob_by_resp[1315], context_prob_by_resp[1316], context_prob_by_resp[1317], context_prob_by_resp[1318], context_prob_by_resp[1319], context_prob_by_resp[1320], context_prob_by_resp[3041], context_prob_by_resp[3042], context_prob_by_resp[3043], context_prob_by_resp[3044], context_prob_by_resp[3045], context_prob_by_resp[3046], context_prob_by_resp[3047], context_prob_by_resp[3048], context_prob_by_resp[3049], context_prob_by_resp[3050], context_prob_by_resp[3051], context_prob_by_resp[3052], context_prob_by_resp[3053], context_prob_by_resp[3054], context_prob_by_resp[3055], context_prob_by_resp[3056], context_prob_by_resp[3057], context_prob_by_resp[3058], context_prob_by_resp[3059], context_prob_by_resp[3060]
Such high values indicate incomplete mixing and biased estimation.
You should consider regularizating your model with additional prior information or a more effective parameterization.

Processing complete.
</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="56">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    context_discrete_projection_model.model_fit,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"verb_prob"</span>, <span class="st">"context_prob"</span>],</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">12</span>),</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-59-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><span class="math display">\[\begin{align*} &amp;c ∼ \texttt{JDS}
&amp;p ∼ \texttt{knowsJDS} \ &amp;η ( τₚ ∼ \texttt{Bernoulli}(p); τ_c ∼ \texttt{Bernoulli}(c); η(τₚ ∨ τ_c) ) \end{align*}\]</span></p>
<div class="cell" data-tags="[]" data-execution_count="57">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>fully_gradient_model_noncentered_path <span class="op">=</span> os.path.join(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    model_dir, <span class="st">"projection-model/fully-gradient/fully-gradient-likelihoods.stan"</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(fully_gradient_model_noncentered_path, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    display(HTML(highlight(f.read(), StanLexer(), HtmlFormatter())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="highlight"><pre><span></span><span class="kn">functions</span> <span class="p">{</span>
  <span class="kt">real</span> <span class="n">truncated_normal_lpdf</span><span class="p">(</span><span class="kt">real</span> <span class="n">x</span><span class="p">,</span> <span class="kt">real</span> <span class="n">mu</span><span class="p">,</span> <span class="kt">real</span> <span class="n">sigma</span><span class="p">,</span> <span class="kt">real</span> <span class="n">a</span><span class="p">,</span> <span class="kt">real</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">normal_lpdf</span><span class="p">(</span><span class="n">x</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> 
           <span class="nb">log_diff_exp</span><span class="p">(</span><span class="nb">normal_lcdf</span><span class="p">(</span><span class="n">b</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> 
                        <span class="nb">normal_lcdf</span><span class="p">(</span><span class="n">a</span> <span class="p">|</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="kt">real</span> <span class="n">log_lik_lpdf</span><span class="p">(</span><span class="kt">real</span> <span class="n">resp</span><span class="p">,</span> <span class="kt">real</span> <span class="n">verb_prob</span><span class="p">,</span> <span class="kt">real</span> <span class="n">context_prob</span><span class="p">,</span> <span class="kt">real</span> <span class="n">sigma</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">real</span> <span class="n">prob_both_false</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">verb_prob</span><span class="p">)</span> <span class="o">*</span> 
                           <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">context_prob</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">prob_at_least_one_true</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">prob_both_false</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="n">truncated_normal_lpdf</span><span class="p">(</span><span class="n">resp</span> <span class="p">|</span> <span class="n">prob_at_least_one_true</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="58">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FullyGradientProjectionModel(ProjectionModel):</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    stan_functions_block_file <span class="op">=</span> os.path.join(</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>        model_dir, <span class="st">"projection-model/fully-gradient/fully-gradient-likelihoods.stan"</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    stan_file <span class="op">=</span> os.path.join(</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>        model_dir, <span class="st">"projection-model/fully-gradient/fully-gradient-model.stan"</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="59">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model <span class="op">=</span> FullyGradientProjectionModel(norming_model)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model.fit(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    data_projection, iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>17:41:48 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
17:42:00 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
17:42:00 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
17:42:00 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.hpp /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
rm -f /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o

17:42:00 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
17:42:11 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
17:42:11 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
17:42:11 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.hpp /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
rm -f /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o

17:42:11 - cmdstanpy - INFO - Chain [1] start processing
17:42:12 - cmdstanpy - INFO - Chain [1] done processing
17:42:12 - cmdstanpy - INFO - CmdStan start processing
17:52:38 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with context-specific priors derived from context-specific posteriors from prior_model.
Writing STAN file to models/projection-model/fully-gradient/fully-gradient-model.stan...
Fitting model by sampling...
Initializing sampling at MAP...
Writing STAN file to models/projection-model/fully-gradient/fully-gradient-model.stan...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a6a64455348545f5a1da2dd8edeed334","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c0385b9d0b51423a9db293985b9d46a9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"13e806baed784ffc822f85f689663089","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6981b17bd1d84faaa8c554b0ddeda6c4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>&lt;__main__.FullyGradientProjectionModel at 0xffff3bc8b640&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="60">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fully_gradient_projection_model.raw_model_fit.diagnose())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing csv files: /tmp/tmp_c0tivx9/fully-gradient-modelkg0d35x0/fully-gradient-model-20230528174212_1.csv, /tmp/tmp_c0tivx9/fully-gradient-modelkg0d35x0/fully-gradient-model-20230528174212_2.csv, /tmp/tmp_c0tivx9/fully-gradient-modelkg0d35x0/fully-gradient-model-20230528174212_3.csv, /tmp/tmp_c0tivx9/fully-gradient-modelkg0d35x0/fully-gradient-model-20230528174212_4.csv

Checking sampler transitions treedepth.
Treedepth satisfactory for all transitions.

Checking sampler transitions for divergences.
No divergent transitions found.

Checking E-BFMI - sampler transitions HMC potential energy.
E-BFMI satisfactory.

The following parameters had fewer than 0.001 effective draws per transition:
  subj_intercept_verb_z[66], subj_intercept_verb_z[169], subj_intercept_context_z[169], subj_intercept_verb[66], subj_intercept_verb[169], subj_intercept_context[169], log_lik[1301], log_lik[1302], log_lik[1303], log_lik[1304], log_lik[1305], log_lik[1309], log_lik[1311], log_lik[1315], log_lik[1317], log_lik[1319], log_lik[1320], log_lik[3362], log_lik[3363], log_lik[3364], log_lik[3366], log_lik[3367], log_lik[3369], log_lik[3372], log_lik[3375], log_lik[3376], log_lik[3380], verb_prob_by_resp[1301], verb_prob_by_resp[1302], verb_prob_by_resp[1303], verb_prob_by_resp[1304], verb_prob_by_resp[1305], verb_prob_by_resp[1309], verb_prob_by_resp[1311], verb_prob_by_resp[1313], verb_prob_by_resp[1315], verb_prob_by_resp[1317], verb_prob_by_resp[1319], verb_prob_by_resp[1320], verb_prob_by_resp[3365], verb_prob_by_resp[3368], verb_prob_by_resp[3370], verb_prob_by_resp[3371], verb_prob_by_resp[3372], verb_prob_by_resp[3373], verb_prob_by_resp[3374], verb_prob_by_resp[3376], verb_prob_by_resp[3377], verb_prob_by_resp[3378], verb_prob_by_resp[3380], context_prob_by_resp[3362], context_prob_by_resp[3363], context_prob_by_resp[3364], context_prob_by_resp[3365], context_prob_by_resp[3366], context_prob_by_resp[3367], context_prob_by_resp[3368], context_prob_by_resp[3369], context_prob_by_resp[3370], context_prob_by_resp[3371], context_prob_by_resp[3373], context_prob_by_resp[3374], context_prob_by_resp[3375], context_prob_by_resp[3377], context_prob_by_resp[3378]
Such low values indicate that the effective sample size estimators may be biased high and actual performance may be substantially lower than quoted.

The following parameters had split R-hat greater than 1.05:
  context_intercept_z[6], context_intercept_z[10], context_intercept_z[16], context_intercept_z[24], context_intercept_z[26], context_intercept_z[34], context_intercept_z[35], subj_intercept_verb_z[66], subj_intercept_verb_z[150], subj_intercept_verb_z[163], subj_intercept_verb_z[169], subj_intercept_verb_z[256], subj_intercept_context_z[163], subj_intercept_context_z[169], context_intercept[6], context_intercept[10], context_intercept[16], context_intercept[24], context_intercept[26], context_intercept[34], subj_intercept_verb[66], subj_intercept_verb[150], subj_intercept_verb[163], subj_intercept_verb[169], subj_intercept_verb[256], subj_intercept_context[163], subj_intercept_context[169], log_lik[1301], log_lik[1302], log_lik[1303], log_lik[1304], log_lik[1305], log_lik[1309], log_lik[1311], log_lik[1313], log_lik[1315], log_lik[1317], log_lik[1319], log_lik[1320], log_lik[2985], log_lik[2990], log_lik[2995], log_lik[3245], log_lik[3247], log_lik[3249], log_lik[3253], log_lik[3254], log_lik[3257], log_lik[3361], log_lik[3362], log_lik[3363], log_lik[3364], log_lik[3366], log_lik[3367], log_lik[3368], log_lik[3369], log_lik[3371], log_lik[3372], log_lik[3375], log_lik[3376], log_lik[3378], log_lik[3379], log_lik[3380], log_lik[5101], log_lik[5102], log_lik[5103], log_lik[5104], log_lik[5106], log_lik[5107], log_lik[5108], log_lik[5110], log_lik[5114], log_lik[5115], log_lik[5116], log_lik[5119], log_lik[5246], verb_prob_by_resp[1301], verb_prob_by_resp[1302], verb_prob_by_resp[1303], verb_prob_by_resp[1304], verb_prob_by_resp[1305], verb_prob_by_resp[1307], verb_prob_by_resp[1309], verb_prob_by_resp[1311], verb_prob_by_resp[1313], verb_prob_by_resp[1315], verb_prob_by_resp[1317], verb_prob_by_resp[1319], verb_prob_by_resp[1320], verb_prob_by_resp[2985], verb_prob_by_resp[2990], verb_prob_by_resp[2993], verb_prob_by_resp[2994], verb_prob_by_resp[2995], verb_prob_by_resp[3241], verb_prob_by_resp[3242], verb_prob_by_resp[3243], verb_prob_by_resp[3244], verb_prob_by_resp[3245], verb_prob_by_resp[3246], verb_prob_by_resp[3247], verb_prob_by_resp[3248], verb_prob_by_resp[3249], verb_prob_by_resp[3250], verb_prob_by_resp[3251], verb_prob_by_resp[3252], verb_prob_by_resp[3253], verb_prob_by_resp[3254], verb_prob_by_resp[3255], verb_prob_by_resp[3256], verb_prob_by_resp[3257], verb_prob_by_resp[3258], verb_prob_by_resp[3259], verb_prob_by_resp[3260], verb_prob_by_resp[3362], verb_prob_by_resp[3365], verb_prob_by_resp[3368], verb_prob_by_resp[3370], verb_prob_by_resp[3371], verb_prob_by_resp[3372], verb_prob_by_resp[3373], verb_prob_by_resp[3374], verb_prob_by_resp[3376], verb_prob_by_resp[3377], verb_prob_by_resp[3378], verb_prob_by_resp[3380], verb_prob_by_resp[5101], verb_prob_by_resp[5102], verb_prob_by_resp[5103], verb_prob_by_resp[5104], verb_prob_by_resp[5106], verb_prob_by_resp[5110], verb_prob_by_resp[5112], verb_prob_by_resp[5114], verb_prob_by_resp[5115], verb_prob_by_resp[5116], verb_prob_by_resp[5119], verb_prob_by_resp[5247], verb_prob_by_resp[5256], verb_prob_by_resp[5257], verb_prob_by_resp[5259], context_prob_by_resp[933], context_prob_by_resp[3241], context_prob_by_resp[3242], context_prob_by_resp[3243], context_prob_by_resp[3245], context_prob_by_resp[3246], context_prob_by_resp[3248], context_prob_by_resp[3249], context_prob_by_resp[3250], context_prob_by_resp[3251], context_prob_by_resp[3252], context_prob_by_resp[3255], context_prob_by_resp[3256], context_prob_by_resp[3259], context_prob_by_resp[3260], context_prob_by_resp[3361], context_prob_by_resp[3362], context_prob_by_resp[3363], context_prob_by_resp[3364], context_prob_by_resp[3365], context_prob_by_resp[3366], context_prob_by_resp[3367], context_prob_by_resp[3368], context_prob_by_resp[3369], context_prob_by_resp[3370], context_prob_by_resp[3371], context_prob_by_resp[3372], context_prob_by_resp[3373], context_prob_by_resp[3374], context_prob_by_resp[3375], context_prob_by_resp[3376], context_prob_by_resp[3377], context_prob_by_resp[3378], context_prob_by_resp[3379], context_prob_by_resp[3380], context_prob_by_resp[4695], context_prob_by_resp[4700], context_prob_by_resp[5102], context_prob_by_resp[5104], context_prob_by_resp[5107], context_prob_by_resp[5108], context_prob_by_resp[5111], context_prob_by_resp[5112], context_prob_by_resp[5115], context_prob_by_resp[5116], context_prob_by_resp[5118], context_prob_by_resp[5119], context_prob_by_resp[5248], context_prob_by_resp[5252], context_prob_by_resp[5253], context_prob_by_resp[5256], context_prob_by_resp[5259]
Such high values indicate incomplete mixing and biased estimation.
You should consider regularizating your model with additional prior information or a more effective parameterization.

Processing complete.
</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="61">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    fully_gradient_projection_model.model_fit,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"verb_prob"</span>, <span class="st">"context_prob"</span>],</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">20</span>),</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-64-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="140">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Discrete</span><span class="ch">\n</span><span class="st">Context Discrete"</span>: fully_discrete_projection_model,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Discrete</span><span class="ch">\n</span><span class="st">Context Gradient"</span>: verb_discrete_projection_model,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Gradient</span><span class="ch">\n</span><span class="st">Context Discrete"</span>: context_discrete_projection_model,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Gradient</span><span class="ch">\n</span><span class="st">Context Gradient"</span>: fully_gradient_projection_model</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>projection_model_comparison <span class="op">=</span> arviz.compare({</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    m_name: m.model_fit <span class="cf">for</span> m_name, m <span class="kw">in</span> models.items()</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>}).reset_index()</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>projection_model_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">rank</th>
<th data-quarto-table-cell-role="th">elpd_loo</th>
<th data-quarto-table-cell-role="th">p_loo</th>
<th data-quarto-table-cell-role="th">elpd_diff</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">se</th>
<th data-quarto-table-cell-role="th">dse</th>
<th data-quarto-table-cell-role="th">warning</th>
<th data-quarto-table-cell-role="th">scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Verb Discrete\nContext Gradient</td>
<td>0</td>
<td>1977.388962</td>
<td>529.493419</td>
<td>0.000000</td>
<td>0.731178</td>
<td>62.782740</td>
<td>0.000000</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Verb Discrete\nContext Discrete</td>
<td>1</td>
<td>1851.768019</td>
<td>391.267807</td>
<td>125.620943</td>
<td>0.028103</td>
<td>56.395583</td>
<td>30.519611</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Verb Gradient\nContext Discrete</td>
<td>2</td>
<td>1475.988699</td>
<td>692.865615</td>
<td>501.400263</td>
<td>0.167403</td>
<td>61.242926</td>
<td>49.677178</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Verb Gradient\nContext Gradient</td>
<td>3</td>
<td>1324.466786</td>
<td>886.750483</td>
<td>652.922176</td>
<td>0.073316</td>
<td>63.066930</td>
<td>52.694271</td>
<td>True</td>
<td>log</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="63">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i projection_model_comparison <span class="op">-</span>w <span class="dv">8</span> <span class="op">-</span>h <span class="dv">4</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(projection_model_comparison, aes(x<span class="op">=</span>rank, y<span class="op">=</span>elpd_loo, ymin<span class="op">=</span>elpd_loo<span class="op">-</span>se, ymax<span class="op">=</span>elpd_loo<span class="op">+</span>se)) <span class="op">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>geom_errorbar(width<span class="op">=</span><span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>geom_point() <span class="op">+</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>scale_x_continuous(labels<span class="op">=</span>projection_model_comparison$index) <span class="op">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>coord_flip() <span class="op">+</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>ylab(expression(<span class="st">"Model Fit (ELPD)"</span>)) <span class="op">+</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>theme(axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>      axis.title.x<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>, color<span class="op">=</span><span class="st">"black"</span>))</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"projection_model_comparison.png"</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-66-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="142">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>verb_probs <span class="op">=</span> []</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m_name, m <span class="kw">in</span> models.items():</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    verb_probs_sub <span class="op">=</span> pd.DataFrame(</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>        m.raw_model_fit.stan_variable(<span class="st">"verb_prob"</span>),</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>m.verb_hash_map</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    verb_probs_sub[<span class="st">"model"</span>] <span class="op">=</span> m_name</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    verb_probs.append(verb_probs_sub)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>verb_probs <span class="op">=</span> pd.concat(verb_probs)</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>verb_probs <span class="op">=</span> pd.melt(verb_probs, id_vars<span class="op">=</span><span class="st">"model"</span>)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>verb_probs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Verb Discrete\nContext Discrete</td>
<td>acknowledge</td>
<td>2.792560e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Verb Discrete\nContext Discrete</td>
<td>acknowledge</td>
<td>2.645730e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Verb Discrete\nContext Discrete</td>
<td>acknowledge</td>
<td>2.881570e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Verb Discrete\nContext Discrete</td>
<td>acknowledge</td>
<td>3.225230e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Verb Discrete\nContext Discrete</td>
<td>acknowledge</td>
<td>3.402130e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">639995</td>
<td>Verb Gradient\nContext Gradient</td>
<td>think</td>
<td>2.971280e-13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">639996</td>
<td>Verb Gradient\nContext Gradient</td>
<td>think</td>
<td>4.118970e-15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">639997</td>
<td>Verb Gradient\nContext Gradient</td>
<td>think</td>
<td>4.224290e-15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">639998</td>
<td>Verb Gradient\nContext Gradient</td>
<td>think</td>
<td>5.664310e-15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">639999</td>
<td>Verb Gradient\nContext Gradient</td>
<td>think</td>
<td>1.117760e-14</td>
</tr>
</tbody>
</table>

<p>640000 rows × 3 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="157">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i verb_probs <span class="op">-</span>w <span class="dv">20</span> <span class="op">-</span>h <span class="dv">15</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(verb_probs, aes(x<span class="op">=</span>fct_reorder(variable, value, .fun <span class="op">=</span> median), y<span class="op">=</span>value, fill<span class="op">=</span>fct_reorder(model, value, .fun <span class="op">=</span> <span class="bu">max</span>))) <span class="op">+</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>geom_boxplot(outlier.color<span class="op">=</span><span class="st">"white"</span>) <span class="op">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>coord_flip() <span class="op">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>scale_fill_manual(name<span class="op">=</span><span class="st">"Model"</span>, values<span class="op">=</span>c(<span class="st">"#133B6C"</span>,<span class="st">"#CD5400"</span>, <span class="st">"#611378"</span>, <span class="st">"#F9D146"</span>)) <span class="op">+</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>theme(axis.title.x<span class="op">=</span>element_blank(),</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>      axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>, color<span class="op">=</span><span class="st">"black"</span>),</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>      axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>, hjust<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>      axis.ticks.y<span class="op">=</span>element_blank(),</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>      legend.title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>      legend.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>),</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>      legend.position<span class="op">=</span><span class="st">"bottom"</span>)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"projection-posterior-distributions-verb.png"</span>, width<span class="op">=</span><span class="dv">20</span>, height<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-68-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="replication" class="level1">
<h1>Replication</h1>
<div class="cell" data-tags="[]" data-execution_count="64">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model.verb_posterior_estimates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">verb</th>
<th data-quarto-table-cell-role="th">verb_mean</th>
<th data-quarto-table-cell-role="th">verb_std</th>
<th data-quarto-table-cell-role="th">order</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>acknowledge</td>
<td>-4.541782</td>
<td>1.389127</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>admit</td>
<td>-4.364653</td>
<td>1.578743</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>announce</td>
<td>-10.943493</td>
<td>2.481787</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>annoyed</td>
<td>6.472510</td>
<td>2.194221</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>be_right_that</td>
<td>-35.028000</td>
<td>8.718410</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>confess</td>
<td>-7.740016</td>
<td>2.049734</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>confirm</td>
<td>-26.757921</td>
<td>6.140028</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>demonstrate</td>
<td>-14.721093</td>
<td>3.365993</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>discover</td>
<td>-0.728762</td>
<td>1.156796</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>establish</td>
<td>-18.868989</td>
<td>3.980437</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>hear</td>
<td>-1.131365</td>
<td>1.158011</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>inform_Sam</td>
<td>3.647321</td>
<td>1.359460</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>know</td>
<td>3.570524</td>
<td>1.420618</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>pretend</td>
<td>-33.782799</td>
<td>7.665137</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>prove</td>
<td>-26.192207</td>
<td>7.804465</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>reveal</td>
<td>-6.617840</td>
<td>1.817684</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>say</td>
<td>-32.272862</td>
<td>7.516435</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>see</td>
<td>1.157292</td>
<td>1.282556</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>suggest</td>
<td>-30.496094</td>
<td>7.609209</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>think</td>
<td>-28.170854</td>
<td>6.606899</td>
<td>19</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="65">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>data_projection_replication <span class="op">=</span> load_projection_data(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    os.path.join(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>        data_dir, </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"projective-probability-replication/contentful.csv"</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>data_projection_replication <span class="op">=</span> data_projection_replication.rename(columns<span class="op">=</span>{<span class="st">"participant"</span>: <span class="st">"workerid"</span>})</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>data_projection_replication</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">slide_number_in_experiment</th>
<th data-quarto-table-cell-role="th">verb</th>
<th data-quarto-table-cell-role="th">contentNr</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">speakerGender</th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">fact_type</th>
<th data-quarto-table-cell-role="th">utterance</th>
<th data-quarto-table-cell-role="th">question</th>
<th data-quarto-table-cell-role="th">subjectGender</th>
<th data-quarto-table-cell-role="th">speakerName</th>
<th data-quarto-table-cell-role="th">subjectName</th>
<th data-quarto-table-cell-role="th">trigger_class</th>
<th data-quarto-table-cell-role="th">response</th>
<th data-quarto-table-cell-role="th">rt</th>
<th data-quarto-table-cell-role="th">workerid</th>
<th data-quarto-table-cell-role="th">item</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2</td>
<td>pretend</td>
<td>13</td>
<td>Jackson ran 10 miles</td>
<td>F</td>
<td>Jackson is obese</td>
<td>factL</td>
<td>Did Laura pretend that Jackson ran 10 miles?</td>
<td>13</td>
<td>F</td>
<td>Donna</td>
<td>Carolyn</td>
<td>NonProj</td>
<td>0.63</td>
<td>2665</td>
<td>1</td>
<td>13L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>establish</td>
<td>18</td>
<td>Julian dances salsa</td>
<td>F</td>
<td>Julian is German</td>
<td>factL</td>
<td>Did Kathleen establish that Julian dances salsa?</td>
<td>18</td>
<td>F</td>
<td>Linda</td>
<td>Sharon</td>
<td>NonProj</td>
<td>0.48</td>
<td>1290</td>
<td>1</td>
<td>18L</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4</td>
<td>be_right_that</td>
<td>6</td>
<td>Mia drank 2 cocktails last night</td>
<td>M</td>
<td>Mia is a nun</td>
<td>factL</td>
<td>Is Ray right that Mia drank 2 cocktails last n...</td>
<td>6</td>
<td>M</td>
<td>Mark</td>
<td>Nicholas</td>
<td>C</td>
<td>0.30</td>
<td>1470</td>
<td>1</td>
<td>6L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5</td>
<td>know</td>
<td>19</td>
<td>Jon walks to work</td>
<td>M</td>
<td>Jon lives 2 blocks away from work</td>
<td>factH</td>
<td>Does Ruth know that Jon walks to work?</td>
<td>19</td>
<td>F</td>
<td>James</td>
<td>Julie</td>
<td>NonProj</td>
<td>0.52</td>
<td>1088</td>
<td>1</td>
<td>19H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6</td>
<td>annoyed</td>
<td>2</td>
<td>Josie went on vacation to France</td>
<td>F</td>
<td>Josie doesn't have a passport</td>
<td>factL</td>
<td>Is Scott annoyed that Josie went on vacation t...</td>
<td>2</td>
<td>M</td>
<td>Sarah</td>
<td>Alexander</td>
<td>NonProj</td>
<td>0.43</td>
<td>754</td>
<td>1</td>
<td>2L</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>22</td>
<td>annoyed</td>
<td>4</td>
<td>Olivia sleeps until noon</td>
<td>M</td>
<td>Olivia works the third shift</td>
<td>factH</td>
<td>Is Jerry annoyed that Olivia sleeps until noon?</td>
<td>4</td>
<td>M</td>
<td>Paul</td>
<td>Benjamin</td>
<td>NonProj</td>
<td>0.83</td>
<td>12423</td>
<td>755</td>
<td>4H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>23</td>
<td>admit</td>
<td>5</td>
<td>Sophia got a tattoo</td>
<td>F</td>
<td>Sophia is a hipster</td>
<td>factH</td>
<td>Did Ben admit that Sophia got a tattoo?</td>
<td>5</td>
<td>M</td>
<td>Dorothy</td>
<td>Edward</td>
<td>C</td>
<td>0.86</td>
<td>11543</td>
<td>755</td>
<td>5H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>24</td>
<td>discover</td>
<td>17</td>
<td>Owen shoveled snow last winter</td>
<td>F</td>
<td>Owen lives in Chicago</td>
<td>factH</td>
<td>Did Cynthia discover that Owen shoveled snow l...</td>
<td>17</td>
<td>F</td>
<td>Ashley</td>
<td>Rachel</td>
<td>NonProj</td>
<td>0.74</td>
<td>7606</td>
<td>755</td>
<td>17H</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>25</td>
<td>see</td>
<td>18</td>
<td>Julian dances salsa</td>
<td>M</td>
<td>Julian is Cuban</td>
<td>factH</td>
<td>Did Kathleen see that Julian dances salsa?</td>
<td>18</td>
<td>F</td>
<td>Steven</td>
<td>Brenda</td>
<td>NonProj</td>
<td>0.92</td>
<td>9266</td>
<td>755</td>
<td>18H</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>26</td>
<td>suggest</td>
<td>14</td>
<td>Jayden rented a car</td>
<td>F</td>
<td>Jayden doesn't have a driver's license</td>
<td>factL</td>
<td>Did Stephanie suggest that Jayden rented a car?</td>
<td>14</td>
<td>F</td>
<td>Lisa</td>
<td>Angela</td>
<td>C</td>
<td>0.16</td>
<td>8158</td>
<td>755</td>
<td>14L</td>
</tr>
</tbody>
</table>

<p>15100 rows × 17 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="66">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>fully_discrete_projection_model_replication <span class="op">=</span> FullyDiscreteProjectionModel(fully_discrete_projection_model)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>fully_discrete_projection_model_replication.fit(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    data_projection_replication, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>17:55:50 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with context- and verb-specific priors derived from context- and verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/fully-discrete/fully-discrete-model.stan...</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>KeyboardInterrupt: </code></pre>
</div>
</div>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>verb_discrete_projection_model_replication <span class="op">=</span> VerbDiscreteProjectionModel(verb_discrete_projection_model)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>verb_discrete_projection_model_replication.fit(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    data_projection_replication, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>context_discrete_projection_model_replication <span class="op">=</span> ContextDiscreteProjectionModel(context_discrete_projection_model)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>context_discrete_projection_model_replication.fit(</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    data_projection_replication, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model_replication <span class="op">=</span> FullyGradientProjectionModel(fully_gradient_projection_model)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model_replication.fit(</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    data_projection_replication, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    fully_discrete_projection_model_replication.model_fit,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"verb_prob"</span>, <span class="st">"context_prob"</span>],</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">20</span>),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bleached" class="level1">
<h1>Bleached</h1>
<div class="cell" data-tags="[]" data-execution_count="68">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>data_projection_bleached <span class="op">=</span> load_projection_data(</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    os.path.join(</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>        data_dir, </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"projective-probability-replication/bleached.csv"</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>data_projection_bleached[<span class="st">"workerid"</span>] <span class="op">=</span> data_projection_bleached.participant</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>data_projection_bleached</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">slide_number_in_experiment</th>
<th data-quarto-table-cell-role="th">verb</th>
<th data-quarto-table-cell-role="th">contentNr</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">speakerGender</th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">fact_type</th>
<th data-quarto-table-cell-role="th">utterance</th>
<th data-quarto-table-cell-role="th">question</th>
<th data-quarto-table-cell-role="th">subjectGender</th>
<th data-quarto-table-cell-role="th">speakerName</th>
<th data-quarto-table-cell-role="th">subjectName</th>
<th data-quarto-table-cell-role="th">trigger_class</th>
<th data-quarto-table-cell-role="th">response</th>
<th data-quarto-table-cell-role="th">rt</th>
<th data-quarto-table-cell-role="th">participant</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">workerid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2</td>
<td>inform_Sam</td>
<td>11</td>
<td>that thing happened</td>
<td>F</td>
<td>Danny is a diabetic</td>
<td>factL</td>
<td>Did Amanda inform Sam that a particular thing ...</td>
<td>11</td>
<td>F</td>
<td>Donna</td>
<td>Shirley</td>
<td>C</td>
<td>0.00</td>
<td>15699</td>
<td>1</td>
<td>11L</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5</td>
<td>confirm</td>
<td>13</td>
<td>that thing happened</td>
<td>F</td>
<td>Jackson is training for a marathon</td>
<td>factH</td>
<td>Did Laura confirm that a particular thing happ...</td>
<td>13</td>
<td>F</td>
<td>Nancy</td>
<td>Janet</td>
<td>C</td>
<td>0.00</td>
<td>6903</td>
<td>1</td>
<td>13H</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6</td>
<td>be_right_that</td>
<td>20</td>
<td>that thing happened</td>
<td>F</td>
<td>Charley lives in Mexico</td>
<td>factH</td>
<td>Is Anna right that a particular thing happened?</td>
<td>20</td>
<td>F</td>
<td>Carol</td>
<td>Nicole</td>
<td>C</td>
<td>0.00</td>
<td>4640</td>
<td>1</td>
<td>20H</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
<td>prove</td>
<td>3</td>
<td>that thing happened</td>
<td>F</td>
<td>Emma is in law school</td>
<td>factH</td>
<td>Did Justin prove that a particular thing happe...</td>
<td>3</td>
<td>M</td>
<td>Lisa</td>
<td>Brandon</td>
<td>C</td>
<td>0.00</td>
<td>5977</td>
<td>1</td>
<td>3H</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>8</td>
<td>admit</td>
<td>2</td>
<td>that thing happened</td>
<td>F</td>
<td>Josie doesn't have a passport</td>
<td>factL</td>
<td>Did Scott admit that a particular thing happened?</td>
<td>2</td>
<td>M</td>
<td>Jennifer</td>
<td>Nicholas</td>
<td>C</td>
<td>0.49</td>
<td>7887</td>
<td>1</td>
<td>2L</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>23</td>
<td>discover</td>
<td>1</td>
<td>that thing happened</td>
<td>F</td>
<td>Mary is taking a prenatal yoga class</td>
<td>factH</td>
<td>Did Patrick discover that a particular thing h...</td>
<td>1</td>
<td>M</td>
<td>Carol</td>
<td>Gregory</td>
<td>NonProj</td>
<td>0.82</td>
<td>2665</td>
<td>50</td>
<td>1H</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>24</td>
<td>suggest</td>
<td>19</td>
<td>that thing happened</td>
<td>M</td>
<td>Jon lives 2 blocks away from work</td>
<td>factH</td>
<td>Did Ruth suggest that a particular thing happe...</td>
<td>19</td>
<td>F</td>
<td>Robert</td>
<td>Anna</td>
<td>C</td>
<td>0.73</td>
<td>2619</td>
<td>50</td>
<td>19H</td>
<td>50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>25</td>
<td>confirm</td>
<td>9</td>
<td>that thing happened</td>
<td>M</td>
<td>Grace loves her sister</td>
<td>factH</td>
<td>Did Andrew confirm that a particular thing hap...</td>
<td>9</td>
<td>M</td>
<td>James</td>
<td>Tyler</td>
<td>C</td>
<td>0.68</td>
<td>1120</td>
<td>50</td>
<td>9H</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>26</td>
<td>hear</td>
<td>11</td>
<td>that thing happened</td>
<td>F</td>
<td>Danny is a diabetic</td>
<td>factL</td>
<td>Did Amanda hear that a particular thing happened?</td>
<td>11</td>
<td>F</td>
<td>Jennifer</td>
<td>Diane</td>
<td>C</td>
<td>0.70</td>
<td>1824</td>
<td>50</td>
<td>11L</td>
<td>50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>27</td>
<td>think</td>
<td>10</td>
<td>that thing happened</td>
<td>M</td>
<td>Zoe is 5 years old</td>
<td>factL</td>
<td>Does Tim think that a particular thing happened?</td>
<td>10</td>
<td>M</td>
<td>Richard</td>
<td>Jacob</td>
<td>NonProj</td>
<td>0.79</td>
<td>1424</td>
<td>50</td>
<td>10L</td>
<td>50</td>
</tr>
</tbody>
</table>

<p>1000 rows × 18 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="73">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>fully_discrete_projection_model_bleached <span class="op">=</span> FullyDiscreteProjectionModel(</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    fully_discrete_projection_model, use_context_prior<span class="op">=</span><span class="va">False</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>fully_discrete_projection_model_bleached.fit(</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    data_projection_bleached, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>17:58:05 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
17:58:17 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
17:58:17 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
17:58:17 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 29, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 30, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 31, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o

17:58:17 - cmdstanpy - INFO - CmdStan start processing
17:59:16 - cmdstanpy - INFO - CmdStan done processing.
17:59:16 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: Exception: Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 3, column 4 to line 5, column 52) (in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 12, column 4 to line 16, column 6) (in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 69, column 4 to line 71, column 6)
Consider re-running with show_console=True if the above output is unclear!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with verb-specific priors derived from verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/fully-discrete/fully-discrete-model.stan...
Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"de4f0664aa0247e2902826909a335d2d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0dcf884b6b484de8af9fcb20381357ab","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f18bdc4b12e34f4c9dcaed8bf618a7ea","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"465c29c7ab7e4b7c91458e6965b0e3c9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>&lt;__main__.FullyDiscreteProjectionModel at 0xffff397fa230&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="74">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>verb_discrete_projection_model_bleached <span class="op">=</span> VerbDiscreteProjectionModel(</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    verb_discrete_projection_model, use_context_prior<span class="op">=</span><span class="va">False</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>verb_discrete_projection_model_bleached.fit(</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    data_projection_bleached, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>17:59:44 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
17:59:55 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
17:59:55 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
17:59:55 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o

17:59:55 - cmdstanpy - INFO - CmdStan start processing
18:00:51 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with verb-specific priors derived from verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/verb-discrete/verb-discrete-model.stan...
Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"90f13da32ad541d086e20de3ab571e71","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f534773345804a52856e2d56a5df3c24","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8dc7a7fca8ac455198c937f284bb422b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"aec619c617504419b95f80ff430381a8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>&lt;__main__.VerbDiscreteProjectionModel at 0xffff39324fd0&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="75">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>context_discrete_projection_model_bleached <span class="op">=</span> ContextDiscreteProjectionModel(</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    context_discrete_projection_model, use_context_prior<span class="op">=</span><span class="va">False</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>context_discrete_projection_model_bleached.fit(</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    data_projection_bleached, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>18:00:55 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
18:01:07 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
18:01:07 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
18:01:07 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o

18:01:07 - cmdstanpy - INFO - CmdStan start processing
18:02:39 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with verb-specific priors derived from verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/context-discrete/context-discrete-model.stan...
Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e617a154ef8348c5ae0a07d91d35ff7b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3fab48fad0af46f2b8f31de071e6f865","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a9b467a217ab45438d6aabefb2777fea","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3a2189fc330742fa8f20ef77f6fc0820","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>&lt;__main__.ContextDiscreteProjectionModel at 0xffff39317430&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="76">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model_bleached <span class="op">=</span> FullyGradientProjectionModel(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    fully_gradient_projection_model, use_context_prior<span class="op">=</span><span class="va">False</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model_bleached.fit(</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    data_projection_bleached, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>18:03:28 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
18:03:40 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
18:03:40 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
18:03:40 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.hpp /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
rm -f /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o

18:03:40 - cmdstanpy - INFO - CmdStan start processing
18:04:20 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with verb-specific priors derived from verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/fully-gradient/fully-gradient-model.stan...
Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ffbfb29d781e4dbfaec47a004f1f60aa","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c6baeb6d2abc48c698e0dbbfdb2ed95f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7365337bf18448c9bb6447b558d2166f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f8b828e08b0949d4b37808a77a18c0a5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>&lt;__main__.FullyGradientProjectionModel at 0xffff395719f0&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="77">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>projection_model_bleached_comparison <span class="op">=</span> arviz.compare({</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Discrete</span><span class="ch">\n</span><span class="st">Context Discrete"</span>: fully_discrete_projection_model_bleached.model_fit,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Discrete</span><span class="ch">\n</span><span class="st">Context Gradient"</span>: verb_discrete_projection_model_bleached.model_fit,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Gradient</span><span class="ch">\n</span><span class="st">Context Discrete"</span>: context_discrete_projection_model_bleached.model_fit,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Gradient</span><span class="ch">\n</span><span class="st">Context Gradient"</span>: fully_gradient_projection_model_bleached.model_fit</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>}).reset_index()</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>projection_model_bleached_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/arviz/stats/stats.py:803: UserWarning: Estimated shape parameter of Pareto distribution is greater than 0.7 for one or more samples. You should consider using a more robust model, this is because importance sampling is less likely to work well if the marginal posterior and LOO posterior are very different. This is more likely to happen with a non-robust model and highly influential observations.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/arviz/stats/stats.py:803: UserWarning: Estimated shape parameter of Pareto distribution is greater than 0.7 for one or more samples. You should consider using a more robust model, this is because importance sampling is less likely to work well if the marginal posterior and LOO posterior are very different. This is more likely to happen with a non-robust model and highly influential observations.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/arviz/stats/stats.py:803: UserWarning: Estimated shape parameter of Pareto distribution is greater than 0.7 for one or more samples. You should consider using a more robust model, this is because importance sampling is less likely to work well if the marginal posterior and LOO posterior are very different. This is more likely to happen with a non-robust model and highly influential observations.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/arviz/stats/stats.py:803: UserWarning: Estimated shape parameter of Pareto distribution is greater than 0.7 for one or more samples. You should consider using a more robust model, this is because importance sampling is less likely to work well if the marginal posterior and LOO posterior are very different. This is more likely to happen with a non-robust model and highly influential observations.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="77">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">rank</th>
<th data-quarto-table-cell-role="th">elpd_loo</th>
<th data-quarto-table-cell-role="th">p_loo</th>
<th data-quarto-table-cell-role="th">elpd_diff</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">se</th>
<th data-quarto-table-cell-role="th">dse</th>
<th data-quarto-table-cell-role="th">warning</th>
<th data-quarto-table-cell-role="th">scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Verb Discrete\nContext Gradient</td>
<td>0</td>
<td>332.845638</td>
<td>81.485908</td>
<td>0.000000</td>
<td>7.693773e-01</td>
<td>22.649044</td>
<td>0.000000</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Verb Discrete\nContext Discrete</td>
<td>1</td>
<td>285.583058</td>
<td>58.592741</td>
<td>47.262580</td>
<td>1.387744e-12</td>
<td>19.401362</td>
<td>12.218257</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Verb Gradient\nContext Gradient</td>
<td>2</td>
<td>259.635296</td>
<td>137.912607</td>
<td>73.210342</td>
<td>8.188340e-02</td>
<td>23.932306</td>
<td>17.639465</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Verb Gradient\nContext Discrete</td>
<td>3</td>
<td>255.201006</td>
<td>135.404597</td>
<td>77.644632</td>
<td>1.487393e-01</td>
<td>22.263381</td>
<td>17.510312</td>
<td>True</td>
<td>log</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="78">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i projection_model_bleached_comparison <span class="op">-</span>w <span class="dv">8</span> <span class="op">-</span>h <span class="dv">4</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(projection_model_bleached_comparison, aes(x<span class="op">=</span>rank, y<span class="op">=</span>elpd_loo, ymin<span class="op">=</span>elpd_loo<span class="op">-</span>se, ymax<span class="op">=</span>elpd_loo<span class="op">+</span>se)) <span class="op">+</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>geom_errorbar(width<span class="op">=</span><span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>geom_point() <span class="op">+</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>scale_x_continuous(labels<span class="op">=</span>projection_model_bleached_comparison$index) <span class="op">+</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>coord_flip() <span class="op">+</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>ylab(expression(<span class="st">"Model Fit (ELPD)"</span>)) <span class="op">+</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>theme(axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>      axis.title.x<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>, color<span class="op">=</span><span class="st">"black"</span>))</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"projection_model_bleached_comparison.png"</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-82-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="169">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    verb_discrete_projection_model_bleached.model_fit,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"verb_prob"</span>, <span class="st">"context_prob"</span>],</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">20</span>),</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-83-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="templatic" class="level1">
<h1>Templatic</h1>
<div class="cell" data-tags="[]" data-execution_count="79">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>data_projection_templatic <span class="op">=</span> load_projection_data(</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    os.path.join(</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>        data_dir, </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"projective-probability-replication/templatic.csv"</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>data_projection_templatic[<span class="st">"workerid"</span>] <span class="op">=</span> data_projection_templatic.participant</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>data_projection_templatic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">slide_number_in_experiment</th>
<th data-quarto-table-cell-role="th">verb</th>
<th data-quarto-table-cell-role="th">contentNr</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">speakerGender</th>
<th data-quarto-table-cell-role="th">fact</th>
<th data-quarto-table-cell-role="th">fact_type</th>
<th data-quarto-table-cell-role="th">utterance</th>
<th data-quarto-table-cell-role="th">question</th>
<th data-quarto-table-cell-role="th">subjectGender</th>
<th data-quarto-table-cell-role="th">speakerName</th>
<th data-quarto-table-cell-role="th">subjectName</th>
<th data-quarto-table-cell-role="th">trigger_class</th>
<th data-quarto-table-cell-role="th">response</th>
<th data-quarto-table-cell-role="th">rt</th>
<th data-quarto-table-cell-role="th">participant</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">workerid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2</td>
<td>prove</td>
<td>11</td>
<td>X happened</td>
<td>M</td>
<td>Danny loves cake</td>
<td>factH</td>
<td>Did Amanda prove that X happened?</td>
<td>11</td>
<td>F</td>
<td>William</td>
<td>Nicole</td>
<td>C</td>
<td>0.58</td>
<td>2892</td>
<td>1</td>
<td>11H</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>annoyed</td>
<td>7</td>
<td>X happened</td>
<td>F</td>
<td>Isabella is a vegetarian</td>
<td>factL</td>
<td>Is Kevin annoyed that X happened?</td>
<td>7</td>
<td>M</td>
<td>Margaret</td>
<td>Jeffrey</td>
<td>NonProj</td>
<td>0.47</td>
<td>1876</td>
<td>1</td>
<td>7L</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4</td>
<td>discover</td>
<td>14</td>
<td>X happened</td>
<td>F</td>
<td>Jayden's car is in the shop</td>
<td>factH</td>
<td>Did Stephanie discover that X happened?</td>
<td>14</td>
<td>F</td>
<td>Karen</td>
<td>Amanda</td>
<td>NonProj</td>
<td>0.67</td>
<td>1854</td>
<td>1</td>
<td>14H</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5</td>
<td>acknowledge</td>
<td>3</td>
<td>X happened</td>
<td>M</td>
<td>Emma is in law school</td>
<td>factH</td>
<td>Did Justin acknowledge that X happened?</td>
<td>3</td>
<td>M</td>
<td>Mark</td>
<td>Gary</td>
<td>C</td>
<td>0.72</td>
<td>2423</td>
<td>1</td>
<td>3H</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6</td>
<td>pretend</td>
<td>9</td>
<td>X happened</td>
<td>M</td>
<td>Grace loves her sister</td>
<td>factH</td>
<td>Did Andrew pretend that X happened?</td>
<td>9</td>
<td>M</td>
<td>Christopher</td>
<td>Justin</td>
<td>NonProj</td>
<td>0.67</td>
<td>9479</td>
<td>1</td>
<td>9H</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>22</td>
<td>reveal</td>
<td>20</td>
<td>X happened</td>
<td>F</td>
<td>Charley lives in Korea</td>
<td>factL</td>
<td>Did Anna reveal that X happened?</td>
<td>20</td>
<td>F</td>
<td>Kimberly</td>
<td>Rebecca</td>
<td>NonProj</td>
<td>0.82</td>
<td>1877</td>
<td>50</td>
<td>20L</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>24</td>
<td>discover</td>
<td>12</td>
<td>X happened</td>
<td>M</td>
<td>Frank has always wanted a pet</td>
<td>factH</td>
<td>Did Melissa discover that X happened?</td>
<td>12</td>
<td>F</td>
<td>Robert</td>
<td>Rachel</td>
<td>NonProj</td>
<td>0.84</td>
<td>1783</td>
<td>50</td>
<td>12H</td>
<td>50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>25</td>
<td>admit</td>
<td>16</td>
<td>X happened</td>
<td>M</td>
<td>Josh is a 5-year old boy</td>
<td>factH</td>
<td>Did Sharon admit that X happened?</td>
<td>16</td>
<td>F</td>
<td>William</td>
<td>Anna</td>
<td>C</td>
<td>0.56</td>
<td>2008</td>
<td>50</td>
<td>16H</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>26</td>
<td>confirm</td>
<td>4</td>
<td>X happened</td>
<td>M</td>
<td>Olivia has two small children</td>
<td>factL</td>
<td>Did Jerry confirm that X happened?</td>
<td>4</td>
<td>M</td>
<td>George</td>
<td>Nicholas</td>
<td>C</td>
<td>0.78</td>
<td>2149</td>
<td>50</td>
<td>4L</td>
<td>50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>27</td>
<td>acknowledge</td>
<td>15</td>
<td>X happened</td>
<td>M</td>
<td>Tony really likes to party with his friends</td>
<td>factH</td>
<td>Did Rebecca acknowledge that X happened?</td>
<td>15</td>
<td>F</td>
<td>Christopher</td>
<td>Julie</td>
<td>C</td>
<td>0.46</td>
<td>2500</td>
<td>50</td>
<td>15H</td>
<td>50</td>
</tr>
</tbody>
</table>

<p>1000 rows × 18 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="80">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>fully_discrete_projection_model_templatic <span class="op">=</span> FullyDiscreteProjectionModel(</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    fully_discrete_projection_model, use_context_prior<span class="op">=</span><span class="va">False</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>fully_discrete_projection_model_templatic.fit(</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    data_projection_templatic, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>18:09:32 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
18:09:44 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
18:09:44 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
18:09:44 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 29, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 30, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.stan', line 31, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/fully-discrete/fully-discrete-model.o

18:09:44 - cmdstanpy - INFO - CmdStan start processing
18:10:36 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with verb-specific priors derived from verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/fully-discrete/fully-discrete-model.stan...
Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cac4bba0a65f4786a4cec1be68d8674d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"83bb933ff75e42ea91e740a25c847750","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d66d7ed58bb742e8b99c7e635bd997c9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"175d9e3431c64a21b00121792a6d811d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>&lt;__main__.FullyDiscreteProjectionModel at 0xffff395a9420&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="81">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>verb_discrete_projection_model_templatic <span class="op">=</span> VerbDiscreteProjectionModel(</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    verb_discrete_projection_model, use_context_prior<span class="op">=</span><span class="va">False</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>verb_discrete_projection_model_templatic.fit(</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    data_projection_templatic, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>18:10:37 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
18:10:49 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
18:10:49 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
18:10:49 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/verb-discrete/verb-discrete-model.o

18:10:49 - cmdstanpy - INFO - CmdStan start processing
18:11:38 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with verb-specific priors derived from verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/verb-discrete/verb-discrete-model.stan...
Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b08204138c5d4b3d9e3d2412779ec581","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a3f010de716a44ef9923ce2382eae3e0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8455f93f11e44877a6c7fbc6d386f886","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6bdd58068a8e42aebc4f3154fbb19aa8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>&lt;__main__.VerbDiscreteProjectionModel at 0xffff395ab910&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="82">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>context_discrete_projection_model_templatic <span class="op">=</span> ContextDiscreteProjectionModel(</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    context_discrete_projection_model, use_context_prior<span class="op">=</span><span class="va">False</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>context_discrete_projection_model_templatic.fit(</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    data_projection_templatic, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>18:11:39 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
18:11:51 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
18:11:51 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
18:11:51 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.hpp /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model
rm -f /home/jovyan/work/projective-content/models/projection-model/context-discrete/context-discrete-model.o

18:11:51 - cmdstanpy - INFO - CmdStan start processing
18:13:04 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with verb-specific priors derived from verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/context-discrete/context-discrete-model.stan...
Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a1a33d1865954a61b19d7810fe0f4658","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4691a376b804485791eed3c72eb2dd83","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f7b2da69369046278c5c28411edf6dd1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c1ce71fe80e0489ba44dfc1420746b02","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>&lt;__main__.ContextDiscreteProjectionModel at 0xffff3954c2b0&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="83">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model_templatic <span class="op">=</span> FullyGradientProjectionModel(</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    fully_gradient_projection_model, use_context_prior<span class="op">=</span><span class="va">False</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>fully_gradient_projection_model_templatic.fit(</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    data_projection_templatic, map_initialization<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    iter_warmup<span class="op">=</span><span class="dv">2_000</span>, iter_sampling<span class="op">=</span><span class="dv">2_000</span>, seed<span class="op">=</span><span class="dv">40392</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>18:13:05 - cmdstanpy - INFO - compiling stan file /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan to exe file /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
18:13:16 - cmdstanpy - INFO - compiled model executable: /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
18:13:16 - cmdstanpy - WARNING - Stan compiler has produced 3 warnings:
18:13:16 - cmdstanpy - WARNING - 
--- Translating Stan model to C++ code ---
bin/stanc  --o=/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.hpp /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 26, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.stan', line 27, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.33.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

--- Compiling, linking C++ code ---
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.hpp
g++ -std=c++1y -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes      -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.78.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"        /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o src/cmdstan/main.o       -Wl,-L,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb" -Wl,-rpath,"/home/jovyan/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb"     stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model
rm -f /home/jovyan/work/projective-content/models/projection-model/fully-gradient/fully-gradient-model.o

18:13:16 - cmdstanpy - INFO - CmdStan start processing
18:13:53 - cmdstanpy - INFO - CmdStan done processing.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model initialized with verb-specific priors derived from verb-specific posteriors from prior_model.
Writing STAN file to models/projection-model/fully-gradient/fully-gradient-model.stan...
Fitting model by sampling...
                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"25aa256f46a54a02b45ba5cf6401334d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0c17280b0377417ebff69f32dfa1cb32","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4caaf003d15d43949977d24ea1a4ce40","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d301c127d8fb44068fc9cd47c798920d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>&lt;__main__.FullyGradientProjectionModel at 0xffff39324040&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="86">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>projection_model_templatic_comparison <span class="op">=</span> arviz.compare({</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Discrete</span><span class="ch">\n</span><span class="st">Context Discrete"</span>: fully_discrete_projection_model_templatic.model_fit,</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Discrete</span><span class="ch">\n</span><span class="st">Context Gradient"</span>: verb_discrete_projection_model_templatic.model_fit,</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Gradient</span><span class="ch">\n</span><span class="st">Context Discrete"</span>: context_discrete_projection_model_templatic.model_fit,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Verb Gradient</span><span class="ch">\n</span><span class="st">Context Gradient"</span>: fully_gradient_projection_model_templatic.model_fit</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>}).reset_index()</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>projection_model_templatic_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/arviz/stats/stats.py:1645: UserWarning: For one or more samples the posterior variance of the log predictive densities exceeds 0.4. This could be indication of WAIC starting to fail. 
See http://arxiv.org/abs/1507.04544 for details
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/arviz/stats/stats.py:1645: UserWarning: For one or more samples the posterior variance of the log predictive densities exceeds 0.4. This could be indication of WAIC starting to fail. 
See http://arxiv.org/abs/1507.04544 for details
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/arviz/stats/stats.py:1645: UserWarning: For one or more samples the posterior variance of the log predictive densities exceeds 0.4. This could be indication of WAIC starting to fail. 
See http://arxiv.org/abs/1507.04544 for details
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/arviz/stats/stats.py:1645: UserWarning: For one or more samples the posterior variance of the log predictive densities exceeds 0.4. This could be indication of WAIC starting to fail. 
See http://arxiv.org/abs/1507.04544 for details
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="86">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">rank</th>
<th data-quarto-table-cell-role="th">elpd_waic</th>
<th data-quarto-table-cell-role="th">p_waic</th>
<th data-quarto-table-cell-role="th">elpd_diff</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">se</th>
<th data-quarto-table-cell-role="th">dse</th>
<th data-quarto-table-cell-role="th">warning</th>
<th data-quarto-table-cell-role="th">scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Verb Discrete\nContext Gradient</td>
<td>0</td>
<td>346.285329</td>
<td>96.435562</td>
<td>0.000000</td>
<td>8.785926e-01</td>
<td>24.692399</td>
<td>0.000000</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Verb Discrete\nContext Discrete</td>
<td>1</td>
<td>208.744150</td>
<td>47.504816</td>
<td>137.541179</td>
<td>6.583482e-13</td>
<td>15.411018</td>
<td>17.878901</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Verb Gradient\nContext Discrete</td>
<td>2</td>
<td>203.044135</td>
<td>74.082380</td>
<td>143.241193</td>
<td>1.162812e-01</td>
<td>16.074514</td>
<td>19.303837</td>
<td>True</td>
<td>log</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Verb Gradient\nContext Gradient</td>
<td>3</td>
<td>195.398499</td>
<td>107.716485</td>
<td>150.886830</td>
<td>5.126174e-03</td>
<td>20.570656</td>
<td>20.949281</td>
<td>True</td>
<td>log</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="85">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R <span class="op">-</span>i projection_model_templatic_comparison <span class="op">-</span>w <span class="dv">8</span> <span class="op">-</span>h <span class="dv">4</span> <span class="op">-</span>u <span class="kw">in</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> ggplot(projection_model_templatic_comparison, aes(x<span class="op">=</span>rank, y<span class="op">=</span>elpd_loo, ymin<span class="op">=</span>elpd_loo<span class="op">-</span>se, ymax<span class="op">=</span>elpd_loo<span class="op">+</span>se)) <span class="op">+</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>geom_errorbar(width<span class="op">=</span><span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>geom_point() <span class="op">+</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>scale_x_continuous(labels<span class="op">=</span>projection_model_templatic_comparison$index) <span class="op">+</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>coord_flip() <span class="op">+</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>ylab(expression(<span class="st">"Model Fit (ELPD)"</span>)) <span class="op">+</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>theme(axis.title.y<span class="op">=</span>element_blank(),</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>      axis.title.x<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">20</span>, face<span class="op">=</span><span class="st">"bold"</span>),</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>      axis.text<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">18</span>, color<span class="op">=</span><span class="st">"black"</span>))</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>ggsave(<span class="st">"projection_model_templatic_comparison.png"</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-90-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="168">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> arviz.plot_forest(</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    verb_discrete_projection_model_templatic.model_fit,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"verb_prob"</span>, <span class="st">"context_prob"</span>],</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    combined<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="fl">11.5</span>, <span class="dv">20</span>),</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-91-output-1.png" class="img-fluid"></p>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-degen_prior_2021" class="csl-entry" role="listitem">
Degen, Judith, and Judith Tonhauser. 2021. <span>“<span>Prior Beliefs Modulate Projection</span>.”</span> <em>Open Mind</em> 5 (September): 59–70. <a href="https://doi.org/10.1162/opmi_a_00042">https://doi.org/10.1162/opmi_a_00042</a>.
</div>
<div id="ref-degen_factive_2022" class="csl-entry" role="listitem">
———. 2022. <span>“Are There Factive Predicates? An Empirical Investigation.”</span> <em>Language</em> 98 (3): 552–91. <a href="https://doi.org/10.1353/lan.0.0271">https://doi.org/10.1353/lan.0.0271</a>.
</div>
<div id="ref-kane_intensional_2022" class="csl-entry" role="listitem">
Kane, Benjamin, Will Gantt, and Aaron Steven White. 2022. <span>“Intensional <span>Gaps</span>: <span>Relating</span> Veridicality, Factivity, Doxasticity, Bouleticity, and Neg-Raising.”</span> <em>Semantics and Linguistic Theory</em> 31 (January): 570–605. <a href="https://doi.org/10.3765/salt.v31i0.5137">https://doi.org/10.3765/salt.v31i0.5137</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="aaronstevenwhite/representation-learning-course" data-repo-id="R_kgDOJsrvfQ" data-category="General" data-category-id="DIC_kwDOJsrvfc4CXIDs" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../island-effects/model-fitting-and-comparison.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Model Fitting and Comparison</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../selection/index.html" class="pagination-link">
        <span class="nav-page-text">Module 3: Selection</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>